# The Asteroid Routing Problem: A Benchmark for Expensive Black-Box Permutation Optimization 

Manuel López-Ibáñez ${ }^{(\boxtimes)}$ (D), Francisco Chicano (D), and Rodrigo Gil-Merino<br>ITIS Software, Universidad de Málaga, Málaga, Spain<br>\{manuel.lopez-ibanez, chicano,gilmerino\}@uma.es, chicano@lcc.uma.es


#### Abstract

Inspired by the recent 11th Global Trajectory Optimisation Competition, this paper presents the asteroid routing problem (ARP) as a realistic benchmark of algorithms for expensive bound-constrained black-box optimization in permutation space. Given a set of asteroids' orbits and a departure epoch, the goal of the ARP is to find the optimal sequence for visiting the asteroids, starting from Earth's orbit, in order to minimize both the cost, measured as the sum of the magnitude of velocity changes required to complete the trip, and the time, measured as the time elapsed from the departure epoch until visiting the last asteroid. We provide open-source code for generating instances of arbitrary sizes and evaluating solutions to the problem. As a preliminary analysis, we compare the results of two methods for expensive blackbox optimization in permutation spaces, namely, Combinatorial Efficient Global Optimization (CEGO), a Bayesian optimizer based on Gaussian processes, and Unbalanced Mallows Model (UMM), an estimation-ofdistribution algorithm based on probabilistic Mallows models. We investigate the best permutation representation for each algorithm, either rank-based or order-based. Moreover, we analyze the effect of providing a good initial solution, generated by a greedy nearest neighbor heuristic, on the performance of the algorithms. The results suggest directions for improvements in the algorithms being compared.


Keywords: Spacecraft trajectory optimization $\cdot$ Unbalanced Mallows Model $\cdot$ Combinatorial Efficient Global Optimization $\cdot$ Estimation of distribution algorithms $\cdot$ Bayesian optimization

## 1 Introduction

Several space programs from different countries focus on small bodies orbiting around the Sun and the Earth. Apart from the search for answers about the origin and evolution of the Solar System, there are other practical reasons that space agencies consider. One of these reasons is related to the present decrease of mineral resources on Earth. These resources, heavily used in technological devices like mobile phones and computers, include silicon, quartz, boronite and

others, and are hard to mine for: the density of these minerals is usually high, and they fell to inner strata during Earth formation, which translates into an extra difficulty when mining for these materials. As an alternative to Earth mining for techno-minerals, space agencies have proposed asteroids and near Earth objects (NEOs) $[3,4]$ as near-term mining targets. These objects contain varying amounts of rare earth metals, minerals and water at surface levels, consequently much easier to mine for than on Earth. A clear drawback to these plans is the transport from and to the asteroids, which will imply high consumption of energy. A solution to reduce the energy consumption is to build human settlements on large asteroids and/or on orbit, together with space solar power stations that could fuel spacecrafts and those settlements. This idea firstly appeared on a science-fiction novel and later it was popularized as a "gedankenexperiment" by Dyson in the 60's. Nowadays, the idea of a swarm of space solar power stations is called "the Dyson sphere". In its last edition, the $11^{\text {th }}$ Global Trajectory Optimisation Competition (GTOC11, https://gtoc11.nudt.edu.cn) proposed to computationally implement a Dyson ring, which is a set of space stations (12 in this case) orbiting the Sun in a circular orbit, to mine close to Earth passing-by asteroids. The Dyson ring construction was proposed as an optimisation problem in the context of orbital mechanics. The first part of the optimization problem consists in finding a plan (trajectory) to visit a selected subset of asteroids with a spacecraft launched from Earth. This spacecraft does not return to Earth. The second part of the problem consists in activating a device, called asteroid transfer device or ATD, located in the visited asteroids to guide them to the space stations in the Dyson ring. Once the Dyson ring is formed, regular visits to the space stations in the Dyson ring are supposed to bring the minerals in the asteroids to Earth. We are interested in this paper in solving the first optimization problem, for which we provide a formulation as a challenging expensive black-box permutation problem that we call Asteroid Routing Problem (ARP) that may be used to compare and benchmark optimization approaches.

In recent years, there has been growing interest in tackling expensive blackbox permutation problems $[1,6,9,11]$. In permutation problems, the decision space is the space of permutations of a given length $n$, usually denoted with $S_{n}$. Black-box optimization, as considered in this paper, tackles an optimization problem without requiring an explicit analytical model of its objective function and constraints. Finally, in expensive optimization, each function evaluation is often the result of a costly simulation or physical experiment, thus the total budget of evaluations allowed before returning the best solution found is severely restricted, typically no more than $1000[8,9]$. The combination of these three characteristics gives rise to a challenging family of optimization problems. Typical approaches include estimation-of-distribution algorithms [6] and combinatorial Bayesian optimizers [11] or combinations of both [9].

A potential criticism of recent works is that the benchmark problems considered-e.g., the travelling salesman problem, the linear ordering problem, etc.-are taken from the classical combinatorial optimization literature and they are neither truly expensive nor black-box. The ARP proposed here is much

more expensive to evaluate than classical combinatorial optimization problems, even for short permutations. Moreover, there is no explicit analytical model of the problem from the routing perspective, thus classical techniques such as fast neighborhood evaluation or gradient calculation are not possible. In our formal definition of the ARP, we aim to preserve the most challenging features of the problem, without requiring expert knowledge of the astrophysical details. Benchmark generation and evaluation code is made publicly available. We also provide preliminary results using state-of-the-art optimization methods. Our hope is that this work will raise interest in the field of expensive black-box combinatorial optimisation and its applications to trajectory optimisation.

This paper is structured as follows. Section 2 gives a brief introduction to basic astrodynamical concepts required to understand the problem as an optimization benchmark. We do not explain in detail the underlying calculations because (1) these are standard formulas available in many physics textbooks, (2) they are implemented by multiple open-source software libraries and (3) they are not directly available to any of the optimization algorithms considered here. The optimization model of the proposed Asteroid Routing Problem is given in Sect.3. The optimization algorithms evaluated in this work are described in Sect. 4. We provide an experimental analysis of these algorithms on the ARP in Sect. 5 and conclude in Sect. 6 with a summary of findings and suggestions for further research motivated by these findings as well as possible extensions of the ARP benchmark.

# 2 Background 

In this section we will briefly revise the basic theory behind the astrodynamics of the problem. We will start describing the two-body problem and its solution leading to the Keplerian orbits. Then, we will describe one type of maneuver used by the spacecrafts to change their trajectory in space and we will end this section presenting the Lambert problem to determine the impulses required to reach a point in space and time from any other point.

### 2.1 Two-Body Problem

The dynamics of two bodies in space subject to the gravitational force is determined by Newton's second law of dynamics and gravitation law. Combined, they lead to the following vector equation:

$$
\frac{d^{2} \mathbf{r}}{d t^{2}}=-\frac{\mu}{r^{3}} \mathbf{r}
$$

where $\mathbf{r}$ is the position vector of the second object respect to the first one, $r=|\mathbf{r}|$ is the module of the position vector, $t$ is time, and $\mu$ is usually called gravitational parameter, which for our solar system is typically assumed to be a constant due to the mass of the Sun being much larger than the mass of any other object.

Despite the dynamics of the two bodies happening in 3D space, the conservation of the angular momentum forces the movement to happen in a plane and the analytical solutions of the problem are conic curves (also called Keplerian orbits when they refer to the two-body problem): ellipse (and circumference as a particular case), hyperbola and parabola ${ }^{1}$. Both, the hyperbola and parabola are open curves, which means that the object following one of them will come from outside the solar system and after approaching the Sun will disappear outside the solar system without coming back again. Solar system objects, like planets and asteroids, follow an elliptic (or circular) orbit around the Sun.
![img-0.jpeg](img-0.jpeg)

Fig. 1. The five parameters to describe an elliptic orbit.

When we fix a reference frame in space, elliptic orbits can be characterized by five orbital elements: $a$ (semi-major axis), $e$ (eccentricity), $i$ (inclination), $\omega$ (argument of periapsis ${ }^{2}$ ) and $\Omega$ (longitude of the ascending node) (see Fig. 1). The position of the object in the orbit is characterized by a sixth parameter which changes with time: the true anomaly, $\nu$. The term epoch is used in this context to refer to a specific date and time. The movement of an object, i.e., its position and velocity vectors, in an elliptical orbit is completely determined by the six orbital elements described above in a given epoch.

When there are more than two bodies, as it happens in our solar system, the movement equations cannot be solved analytically, except for a few particular cases. In that non-analytical case, the solution of the two-body problem is still useful. The presence of additional bodies can be considered in most of the cases a minor perturbation in the Hamiltonian describing the two-body problem and, as a consequence, the orbital elements are slowly changing with time [5, Chapter 11]. In our formulation of the problem, however, we do not consider these perturbations, and we assume that all objects follow a Keplerian orbit.

[^0]
[^0]:    ${ }^{1}$ The trajectory of the second object could also be linear, but this is not of practical interest, because this would end with the object destroyed in the Sun.
    ${ }^{2}$ The periapsis is the nearest point of an elliptic orbit to the object in the focus. When the object is the Sun, the periapsis is also called perihelion.

# 2.2 Maneuvers in Space 

Artificial spacecrafts also follow a Keplerian orbit around the Sun when they are far from the gravitational influence of the Earth or any other solar system object. They usually have an engine that allows them to change the orbit using operations called maneuvers. There are two main kinds of maneuvers: continuous and impulsive. In a continuous maneuver the engine of the spacecraft is on during a long period of time (e.g., days) and generates a force whose direction and magnitude can be controlled. We will only consider impulsive maneuvers here.

Impulsive maneuvers cover a wide range of different space maneuvers, from small orbital adjustments when two spacecrafts encounter each other, to large orbital corrections between a low-Earth orbit and an interplanetary transit. To carry out an impulsive maneuver, usually small engine firings take place, changing only the direction and magnitude of the velocity vector instantaneously. This means that the position vector does not change during the impulse, which, although an idealisation, it works in most situations. The advantage of treating the impulsive maneuver in this way is that it avoids solving the equations of motion including the thrusts. Under these assumptions, the trajectory of the spacecraft is still a Keplerian orbit where the orbital elements change instantaneously at the point where the impulsive maneuver happens.

### 2.3 Lambert Problem

At the heart of Astrodynamics, a key problem is to determine the Keplerian orbit connecting two positions in a given period of time $\Delta t$. This is the Lambert's problem, also known as the Gauss' problem [7].

We can use the solution of Lambert's problem to determine the impulsive maneuvers required for a spacecraft to do a rendezvous with an asteroid. The transit orbit and impulsive maneuvers can be completely characterized by two times: the epoch at which the transit starts $\tau$ and the transit time $t$. These two times determine the two points $P_{1}$ and $P_{2}$ in space we need to join. $P_{1}$ is the point at which the spacecraft is at $\tau . P_{2}$ is the point at which the asteroid is at $\tau+t$. Lambert's problem is solved to go from $P_{1}$ to $P_{2}$ in time $t$. Two impulsive maneuvers are used to move from $P_{1}$ to $P_{2}$. A first impulsive maneuver $\Delta \mathbf{v}_{1}$ at $P_{1}$ inserts the spacecraft in the transit orbit determined by solving Lambert's problem. A second impulsive maneuver $\Delta \mathbf{v}_{2}$ at $P_{2}$ inserts the spacecraft in the same orbit as the asteroid (rendezvous). Let's denote with $s$ the orbit of the spacecraft (six orbital parameters in an epoch) and with $a$ the orbit of the asteroid ${ }^{3}$. Then, $\Delta \mathbf{v}_{1}$ and $\Delta \mathbf{v}_{2}$ are determined by $s, a, \tau$ and $t$ :

$$
\left(\Delta \mathbf{v}_{1}, \Delta \mathbf{v}_{2}\right)=\operatorname{Lambert}(s, a, \tau, t)
$$

[^0]
[^0]:    ${ }^{3}$ We previously used $a$ to mean the semi-major axis of an orbit, from now on we will use it to denote the complete orbit of an asteroid.

# 3 Asteroid Routing Problem 

The Asteroid Routing Problem consists in finding a route followed by a spacecraft launched from Earth to visit a given set of $n$ asteroids $A=\left\{a_{1}, a_{2}, \ldots, a_{n}\right\}$ that minimizes both the sum of velocity impulses required by the route (related to consumption) and the total time required to visit all of them. A solution to this problem is a pair $(\pi, \mathbf{t})$, where $\pi \in S_{n}$ is a permutation representing the order in which the asteroids are visited and $\mathbf{t} \in \mathbb{R}_{>0}^{2 n}$ is a vector of $2 n$ non-negative real numbers representing parking and transit times to reach each asteroid.

We will consider a start epoch $\tau_{0}$, determined by the instance, when the spacecraft is on Earth. The spacecraft remains on Earth during a time $t_{1}$ after $\tau_{0}$. Then, it is launched at epoch $\tau_{0}+t_{1}$ to reach the first asteroid in the sequence, $a_{\pi(1)}$, using a transit orbit computed by solving Lambert's problem between the Earth and the asteroid. In the launch, the spacecraft experiments an impulse $\Delta \mathbf{v}_{1}$ that inserts the spacecraft in a transit orbit to reach asteroid $a_{\pi(1)}$ in time $t_{2}$ after the launch epoch. Once the asteroid is reached, a new impulse $\Delta \mathbf{v}_{2}$ is used to make the spacecraft to follow the orbit of asteroid $a_{\pi(1)}$.

In order to visit the $i$-th asteroid, $a_{\pi(i)}$, for $i>1$, the spacecraft remains during time $t_{2 i-1}$ in the orbit of asteroid $a_{\pi(i-1)}$ and receives an impulse $\Delta \mathbf{v}_{2 i-1}$ to reach asteroid $a_{\pi(i)}$ in time $t_{2 i}$. Then, a new impulse $\Delta \mathbf{v}_{2 i}$ changes the orbit of the spacecraft to coincide with the one of $a_{\pi(i)}$.

For the transit between asteroids $a_{\pi(i-1)}$ and $a_{\pi(i)}$, the impulses $\Delta \mathbf{v}_{2 i-1}$ and $\Delta \mathbf{v}_{2 i}$ are computed using Eq. (2). All times at odd positions of the time vector, $t_{2 i-1}$, are parking times, because the spacecraft is waiting in an asteroid (or Earth's) orbit, while the times at even positions of the time vector, $t_{2 i}$ are transit times, because the spacecraft is traveling through a transit orbit to reach the next asteroid.

The two objectives of the problem to minimize are the sum of all the velocity impulses, which is related to energy consumption, and the sum of all parking and transit times, which gives the elapsed time from launch to arriving at the last asteroid. More formally, the two objectives are:

$$
\Delta v=\sum_{i=1}^{2 n}\left|\Delta \mathbf{v}_{i}\right| \quad \text { and } \quad T=\sum_{i=1}^{2 n} t_{i}
$$

where $\Delta \mathbf{v}_{i}$ is computed as follows:

$$
\left(\Delta \mathbf{v}_{2 i-1}, \Delta \mathbf{v}_{2 i}\right)=\operatorname{Lambert}\left(a_{\pi(i-1)}, a_{\pi(i)}, \tau_{i-1}, t_{2 i}\right)
$$

where $\tau_{i-1}=\tau_{0}+\sum_{j=1}^{2 i-1} t_{j}$ is the launch epoch from orbit $a_{\pi(i-1)}$ and we consider that $a_{\pi(0)}$ is Earth's orbit.

An instance of the problem is completely determined by the orbital parameters at a given epoch of Earth and all asteroids, the starting epoch $\tau_{0}$ and the gravitational parameter $\mu$.

In this paper, we will focus on a scalarized variant of the above bi-objective problem that simply aggregates the two objectives in Eq. (3) as follows:

$$
f(\pi, \mathbf{t})=\Delta v+\frac{2 \mathrm{~km} / \mathrm{s}}{30 \text { days }} \cdot T
$$

where the constant in front of $T$ is based on preliminary experiments.

# 4 Optimization Algorithms 

In order to use the ARP as a benchmark problem for expensive black-box combinatorial optimization, we tackle the problem in a hierarchical manner. The inner optimization problem decides the values of the vector of times given a permutation of the asteroids, while the outer problem aims to find an optimal permutation of the asteroids. Since our focus here is the outer problem, we always tackle the inner problem using the deterministic SLSQP (Sequential Least Squares Programming) algorithm, thus ensuring that we obtain the same objective function value given the same permutation. For the outer problem, we evaluate and compare two algorithms for expensive black-box optimization problems, namely, Unbalanced Mallows Model (UMM) [6] and Combinatorial Efficient Global Optimization (CEGO) [11]. In addition, we study the effect that a good initial solution has on the behavior of the black-box algorithms. This initial solution is found by means of a gray-box greedy nearest neighbor heuristic. All these algorithms are described below.

### 4.1 Sequential Least Squares Programming (SLSQP)

The inner optimization of the vector of times is done using the implementation of SLSQP provided by SciPy [10] without an explicit gradient, which is estimated by the SLSQP algorithm using 2-point finite differences with an absolute step size of $1.49 \mathrm{e}-08$. Each transfer is optimized independently, that is, SLSQP solves a sequence of $n$ problems with two numerical decision variables $\left(x_{0}, x_{1}\right)$, which correspond respectively to the parking and transit times to visit a particular asteroid. Parking times are bounded by $[0,730]$, while transit times are bounded by $[1,730]$, both measured in days.

### 4.2 Greedy Nearest Neighbor Heuristic

A reasonably good permutation of the asteroids can be generated by iteratively visiting the nearest asteroid, in Euclidean distance, to the last-visited asteroid, after calculating the positions of all unvisited asteroids at the arrival time at the last-visited asteroid. This heuristic is presented in Algorithm 1. The algorithm keeps track of the orbit of the spacecraft $s$ and its arrival time (epoch) $\tau$ at the last-visited asteroid, which are initialized to the Earth's orbit $a_{\pi(0)}$ and the initial epoch $\tau_{0}$, and a set of unvisited asteroids $U$. At each iteration $i$, an

asteroid $a_{\pi(i)}$ is chosen from $U$ according to the minimum value of $d(s, a, \tau)$, which calculates the Euclidean distance between the Cartesian positions of the orbits of the spacecraft $s$ and asteroid $a$ when both are considered at time $\tau$. After the asteroid $a_{\pi(i)}$ is chosen, we solve the inner problem-using SLSQP as described above-to find the parking time $t_{2 i-1}$ at asteroid $a_{\pi(i-1)}$ and transit time $t_{2 i}$ to asteroid $a_{\pi(i)}$. The algorithm finishes when all asteroids are visited, which results in a permutation $\pi$ of the asteroids and the corresponding vector $\mathbf{t}$ of parking and transit times.

```
Algorithm 1. Greedy Nearest Neighbor Heuristic.
\(s:=a_{\pi(0)} \quad / /\) Earth's orbit
\(\tau:=\tau_{0} \quad / /\) Epoch of the spacecraft
\(U:=\{1, \ldots, n\}\)
for \(i:=1\) to \(n-1\) do
    \(\pi(i):=\arg \min _{j \in U} d\left(s, a_{j}, \tau\right) \quad / /\) Euclidean distance between orbits at epoch \(\tau\)
    \(\left(t_{2 i-1}, t_{2 i}\right):=\operatorname{SLSQP}\left(s, a_{\pi(i)}\right) \quad / /\) Solve inner problem
    \(\tau:=\tau+t_{2 i-1}+t_{2 i}\)
    \(U:=U \backslash\{\pi(i)\}\)
    \(s:=a_{\pi(i)}\)
return \((\pi, \mathbf{t})\)
```


# 4.3 Unbalanced Mallows Model (UMM) 

The UMM algorithm [6] is an estimation-of-distribution algorithm based on the Mallows model and unbalanced Borda learning. The Mallows model for permutation spaces is defined by a reference permutation $\sigma_{0}$ and a dispersion parameter $\theta$, which are analogous to the mean and variance of the Gaussian distribution. At each step of UMM, the permutations evaluated so far together with their objective values are used to calculate a weighted mean permutation $\tilde{\sigma}_{0}$. From this $\tilde{\sigma}_{0}$ and a value of the dispersion parameter $\theta$, a new permutation is sampled at each iteration from the Mallows model. The dispersion parameter $\theta$ is set by UMM in such a way that, at the first iteration, the expected Kendall's- $\tau$ distance of newly sampled permutations from the reference permutation is at half of the expected distance of an uniform sample. In subsequent iterations, the parameter $\theta$ is adjusted such that the expected Kendall's- $\tau$ distance linearly decreases until the expected distance is 1 at the last iteration.

Empirical results of UMM on expensive black-box variants of the linear ordering problem and the permutation flowshop scheduling problem showed results [6] comparable to the Combinatorial Efficient Global Optimization (CEGO), with the additional benefit of being computationally much less expensive than CEGO.

### 4.4 Combinatorial Efficient Global Optimization (CEGO)

CEGO extends classical Bayesian optimizers based on Gaussian processes to unconstrained black-box combinatorial optimization problems [11]. A Gaussian

process may be used as a surrogate of the continuous landscape of an expensive optimization problem. In order to model the landscape of a permutation space, CEGO uses a distance measure for permutation spaces, such as the Kendall's- $\tau$ distance, to interpolate between solutions. CEGO uses a genetic algorithm (GA) to explore the landscape of the surrogate model. The GA optimizes the expected improvement criterion, which takes into account both the expected mean and variance of a solution. The solution returned by the GA is then evaluated on the true objective function and this information is used to update the Gaussian process surrogate model.

# 5 Experimental Study 

In this section we describe the experiments performed and the results obtained. Our goal is to answer two research questions:

RQ1: How do the algorithms perform on the problem in a black-box setting (without any problem knowledge)?
RQ2: How do they perform when some a priori information about the problem, in the form of a good initial solution, is introduced?

In Subsect. 5.1 the methodology used to answer both research questions is presented. Then, the experimental results to answer RQ1 and RQ2 are presented and described in Subsect. 5.2 and 5.3, respectively.

### 5.1 Experimental Methodology

We prepared an instance generator that, given an instance size $n$ and seed for the random number generator, randomly selects $n$ asteroids from the 83453 asteroids provided by the GTOC11 competition to create an instance of the ARP. In this manner, we generated two instances (seeds 42 and 73 ) of each size $n=\{10,15,20,25,30\}$. In the remainder of the paper, instances are named $n_{-}$seed, that is, instance 10.73 is an instance of size 10 generated with seed 73 .

In our first set of experiments, designed to answer RQ1, both UMM and CEGO start the search from a set of 10 initial solutions generated by a max-min-distance sequential design, that is, solutions are added iteratively to a set of existing solutions by maximizing the minimum distance to solutions already in the set. The first solution in the set is generated uniformly at random. Generating the max-min-distance design only takes into account the distance between permutations and, thus, it does not require any evaluation of the objective function. These 10 solutions are then evaluated on the objective function function (Eq. 5) and they become the initial population of either CEGO or UMM. In order to answer RQ2, we initialize the max-min-distance design with the heuristic solution returned by the greedy nearest neighbor heuristic described above.

Both UMM and CEGO stop after evaluating 400 permutations using the objective function (Eq. (5)). Each evaluation requires solving the inner problem

by optimizing the vector of times $\mathbf{t}$ using a sequence of $n$ runs of SLQSP. Each run $i$ of SLSQP optimizes the pair of parking and transit times $\left(t_{2 i-1}, t_{2 i}\right)$, starting from the initial solution $(0,30)$ and performing a maximum of 1000 iterations.

For each algorithm, we consider two representations, namely, whether the permutations are represented as the order or as the ranking of the asteroids in the visiting sequence. The order-based representation is the one used in the description of the problem in Sect. 3, i.e., $\pi(i)=j$ denotes that asteroid $j$ is visited at step $i$ of the route. Its ranking-based counterpart is given by its inverse $\pi^{-1}$, where $\pi(i)=j \Leftrightarrow \pi^{-1}(j)=i$. This distinction is important when calculating distances between permutations, learning a probability distribution, as done by UMM, or a surrogate model, as done by CEGO [6].

The GA used by CEGO to explore the surrogate model uses a budget of $10^{4}$ evaluations of the surrogate model, population size of 20 individuals, cycle crossover for permutations with crossover rate of 0.5 , swap mutation (i.e., exchanging two randomly selected elements) with mutation rate of $1 / n$, and tournament selection of size 2 with probability of 0.9 . The population used by the GA is different from the solutions evaluated by CEGO because the GA explores the surrogate model, which does not require evaluations of the expensive problem.

We use here the original implementation of GECO v2.4.2 (https://cran.rproject.org/package=CEGO). UMM is implemented in Python based on the original code [6]. We have implemented the proposed ARP benchmark in Python using the software package poliasitro (v0.16) [2] for astrophysical calculations.

Each experiment was repeated 30 times with different random seeds. The experiments were run in the Picasso supercomputing facility of the University of Málaga with 126 SD530 servers with Intel Xeon Gold 6230R (26 cores each) at $2.10 \mathrm{GHz}, 200 \mathrm{~GB}$ of RAM and an InfiniBand HDR100 network.

# 5.2 Results of the Black-Box Setting 

In this section we compare UMM and CEGO (combined with SLSQP) in a black-box setting to solve the 10 instances of the ARP. Table 1 shows the results of CEGO and UMM using the two representations, rank-based or order-based. As a baseline, we show the results obtained by a simple random search that iteratively evaluates 400 random permutations. We can also see in Fig. 2 the evolution of the search for two particular instances. Each plot shows as a solid line the mean, over 30 runs, of the best objective value found up to a given number of function evaluations. The $95 \%$ confidence interval around the mean is shown as a shaded region. We applied the non-paired Wilcoxon sumrank test to compare the different algorithm configurations in each instance. The p-values are shown in Table 2. We assume that the differences are statistically significant when the p-value is below 0.01 (confidence level).

Results show that, whenever there are significant differences (see columns two and three of Table 2), rank-based UMM outperforms order-based UMM in terms of the objective function, whereas order-based CEGO outperforms rankbased CEGO. This result matches what we expect given the assumptions made by each algorithm. That is, UMM internally assumes that the permutation $\pi$ it

Table 1. Objective value of the best solution found by each algorithm in a single run. Mean (and standard deviation) over 30 independent runs. RS denotes random search.

| Instance | CEGO |  |  |  | UMM |  |  |  |  |
| :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
|  | Order |  | Rank |  | Order |  | Rank |  | RS |
| 10.42 | 379.3 | (17.5) | 390.1 | (16.4) | 413.6 | (15.2) | 388.7 | (20.8) | 419.3 | (14.1) |
| 10.73 | 346.0 | (17.7) | 361.0 | (14.3) | 374.5 | (16.6) | 361.4 | (18.9) | 375.2 | (15.3) |
| 15.42 | 575.1 | (29.2) | 610.1 | (27.4) | 626.9 | (26.1) | 594.6 | (37.7) | 636.2 | (18.5) |
| 15.73 | 582.4 | (33.1) | 591.6 | (29.1) | 626.2 | (24.7) | 595.3 | (32.6) | 636.2 | (25.2) |
| 20.42 | 806.2 | (45.2) | 833.2 | (38.7) | 868.9 | (26.9) | 841.6 | (43.7) | 877.8 | (26.4) |
| 20.73 | 839.2 | (49.8) | 838.0 | (43.0) | 883.0 | (28.4) | 876.8 | (32.7) | 897.2 | (26.3) |
| 25.42 | 1048.8 | (51.2) | 1074.5 | (56.5) | 1121.2 | (28.3) | 1076.9 | (48.5) | 1122.1 | (20.8) |
| 25.73 | 1069.1 | (49.5) | 1096.8 | (50.1) | 1131.4 | (35.8) | 1115.5 | (45.5) | 1139.7 | (25.6) |
| 30.42 | 1272.2 | (65.8) | 1334.4 | (66.6) | 1372.0 | (24.3) | 1347.3 | (35.6) | 1357.3 | (38.4) |
| 30.73 | 1320.9 | (63.2) | 1325.1 | (66.4) | 1385.9 | (27.5) | 1360.6 | (51.1) | 1398.6 | (24.9) |

generates represents a ranking $(\pi(3)=6$ means that object 3 has position 6$)$ and, thus, it makes sense that it works better when the fitness function is aligned with this assumption [6]. CEGO, on the other hand, assumes that the permutation it generates represents an order $(\pi(3)=6$ means that the third object is 6$)$, and that explains the good results of CEGO when the objective function interprets the permutation as an order.

If we compare both algorithms, we observe that CEGO is usually better than UMM using both representations (with only two exceptions for the ranking representation in instances 10.42 and 15.42). The best CEGO variant is clearly better than the best UMM variant, although not always with statistical significance (see column four in Table 2).

Given these results, we select rank-based UMM and order-based CEGO for the next step in our analysis.

# 5.3 Results of the Informed Setting 

In this section, we evaluate the effect of providing a good initial solution to the UMM-rank and CEGO-order variants selected above. This initial solution is generated using the greedy nearest neighbor heuristic as the initial point of the max-min-distance sequential design, as explained above, that creates the 10 initial solutions of both UMM and CEGO.

Figure 3 shows the evolution of the algorithms. In addition to the results provided by CEGO and UMM with and without the initial greedy solution, we plot the objective function value of the greedy solution as a horizontal line. Table 3 provides a summary of the results of the two best variants of CEGO and UMM together with the result obtained by the Greedy Nearest Neighbor Heuristic. A first observation is that UMM only reaches the fitness level of the greedy solution after 10 evaluations. The reason is that we evaluate first the 9 random solutions generated by the max-min-distance design to show how much the greedy solution improves over them. Moreover, without knowledge of the

Table 2. p-values of a Wilcoxon sumrank test of all the hypotheses checked in during the experimental study for each instance of the problem. Columns two and three correspond to a test comparing the two representations (rank and order) for CEGO and UMM in a black-box setting. The fourth column compares the best black-box UMM (using ranking) with the best black-box CEGO (using order). The final two columns compare UMM-ranking and CEGO-order in a black-box versus informed settings (including the greedy initialization).

|  | Rank vs. Order |  | CEGO-order | Greedy vs. BB |  |
| :-- | :-- | :-- | :-- | :-- | :-- |
| Instance | CEGO | UMM | vs. UMM-rank | UMM | CEGO |
| 10.42 | $6.46 \mathrm{e}-03$ | $2.00 \mathrm{e}-06$ | $4.48 \mathrm{e}-02$ | $2.65 \mathrm{e}-02$ | $1.18 \mathrm{e}-01$ |
| 10.73 | $2.37 \mathrm{e}-03$ | $1.33 \mathrm{e}-02$ | $7.07 \mathrm{e}-04$ | $8.34 \mathrm{e}-07$ | $1.65 \mathrm{e}-02$ |
| 15.42 | $3.77 \mathrm{e}-05$ | $6.12 \mathrm{e}-04$ | $5.14 \mathrm{e}-02$ | $2.95 \mathrm{e}-11$ | $1.72 \mathrm{e}-12$ |
| 15.73 | $3.35 \mathrm{e}-01$ | $2.75 \mathrm{e}-04$ | $1.50 \mathrm{e}-01$ | $6.52 \mathrm{e}-09$ | $3.69 \mathrm{e}-10$ |
| 20.42 | $1.42 \mathrm{e}-02$ | $8.01 \mathrm{e}-03$ | $2.74 \mathrm{e}-03$ | $2.41 \mathrm{e}-05$ | $3.25 \mathrm{e}-07$ |
| 20.73 | $7.75 \mathrm{e}-01$ | $4.67 \mathrm{e}-01$ | $2.22 \mathrm{e}-03$ | $2.84 \mathrm{e}-11$ | $2.31 \mathrm{e}-11$ |
| 25.42 | $3.71 \mathrm{e}-02$ | $7.74 \mathrm{e}-05$ | $3.45 \mathrm{e}-02$ | $3.02 \mathrm{e}-11$ | $4.04 \mathrm{e}-11$ |
| 25.73 | $4.46 \mathrm{e}-02$ | $1.77 \mathrm{e}-01$ | $5.43 \mathrm{e}-04$ | $2.26 \mathrm{e}-11$ | $2.84 \mathrm{e}-11$ |
| 30.42 | $5.43 \mathrm{e}-04$ | $4.11 \mathrm{e}-03$ | $1.30 \mathrm{e}-05$ | $2.95 \mathrm{e}-11$ | $3.02 \mathrm{e}-11$ |
| 30.73 | $6.12 \mathrm{e}-01$ | $3.71 \mathrm{e}-02$ | $1.83 \mathrm{e}-02$ | $2.78 \mathrm{e}-11$ | $3.00 \mathrm{e}-11$ |

Table 3. Objective value of the best solution found by each algorithm in a single run. For CEGO and UMM, the values are the mean (and standard deviation) over 30 independent runs.

|  |  | CEGO |  |  |  | UMM |  |  |  |
| :-- | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: | :--: |
| Inst | GreedyNN | Order |  | Ord + Greedy |  | Rank |  | Rank + Greedy |  |
| 10.42 | 391.3 | 379.3 | $(17.5)$ | 374.9 | $(6.9)$ | 388.7 | $(20.8)$ | 382.4 | $(1.1)$ |
| 10.73 | 398.3 | 346.0 | $(17.7)$ | 355.9 | $(18.3)$ | 361.4 | $(18.9)$ | 385.0 | $(6.4)$ |
| 15.42 | 508.1 | 575.1 | $(29.2)$ | 497.2 | $(1.1)$ | 594.6 | $(37.7)$ | 501.7 | $(3.8)$ |
| 15.73 | 576.4 | 582.4 | $(33.1)$ | 525.6 | $(4.7)$ | 595.3 | $(32.6)$ | 545.0 | $(9.3)$ |
| 20.42 | 841.7 | 806.2 | $(45.2)$ | 737.0 | $(31.0)$ | 841.6 | $(43.7)$ | 797.6 | $(28.3)$ |
| 20.73 | 691.5 | 839.2 | $(49.8)$ | 661.8 | $(7.8)$ | 876.8 | $(32.7)$ | 684.7 | $(6.1)$ |
| 25.42 | 946.3 | 1048.8 | $(51.2)$ | 881.5 | $(23.3)$ | 1076.9 | $(48.5)$ | 921.7 | $(15.2)$ |
| 25.73 | 918.3 | 1069.1 | $(49.5)$ | 873.6 | $(15.3)$ | 1115.5 | $(45.5)$ | 911.9 | $(10.0)$ |
| 30.42 | 1131.7 | 1272.2 | $(65.8)$ | 1084.6 | $(13.4)$ | 1347.3 | $(35.6)$ | 1115.4 | $(11.0)$ |
| 30.73 | 1024.7 | 1320.9 | $(63.2)$ | 967.7 | $(17.9)$ | 1360.6 | $(51.1)$ | 1017.3 | $(6.9)$ |

greedy solution, CEGO or UMM are only able to match the greedy solution under 400 evaluations on a few small instances $(n \leq 20)$. Unsurprisingly, when starting from the greedy solution, both algorithms outperform their uninformed counterparts. However, UMM struggles to find any improving solutions, whereas

![img-1.jpeg](img-1.jpeg)

Fig. 2. Convergence of the best-so-far objective value over the number of evaluations. Each line is the mean value over 30 runs and the shaded area is the $95 \%$ confidence interval around the mean. The instances shown are 15.42 (top) and 25.73 (bottom).

CEGO is typically able to further improve the greedy solution, although not by much. In the case of UMM, this behavior is explained by the fact that the sampling of new permutations is strongly biased by the relative objective values of the permutations already evaluated. Since the greedy solution is so much better than any other initial permutation, the algorithm remains stuck at the initial permutation. In the case of CEGO, starting from a good initial solution provides a good starting point around which the surrogate model can be built. However, in several instances, after a quick initial improvement of the greedy solution, CEGO appears stuck and unable to further find any improvements. This behavior of CEGO was already reported for other problems [6] and it is attributed to the inability of the surrogate model to accurately estimate the underlying objective function beyond a certain point, thus leading to a blind search.

We also report the mean runtime of CEGO, UMM and the greedy heuristic in Table 4. The runtime of the greedy algorithm is relatively fast, taking around 6 s to generate and evaluate a single solution. UMM requires between 24 and 69 min per run on average, depending on the instance size, where each run involves 400 solution evaluations. The runtime per evaluation is larger than in GreedyNN due to the update of and sampling from the probabilistic model. CEGO also evaluates 400 solutions per run, however, it is more than 100 times slower than

![img-2.jpeg](img-2.jpeg)

Fig. 3. Convergence of the best-so-far objective value over the number of evaluations. Each line is the mean value over 30 runs and the shaded area is the $95 \%$ confidence interval around the mean. The instances shown are 10.73 (top) and 30.42 (bottom).

UMM, requiring almost 2 CPU-days per run on average for the largest instances tested here. Although part of this difference is due to implementation choices, the main difference is the fact that building the Gaussian Process model in CEGO is significantly more expensive than building the probabilistic model in UMM.

Table 4. Mean CPU-time (minutes) of a single run of each algorithm.

| Instance | GreedyNN | CEGO |  | UMM |  |
| :-- | :-- | :-- | :-- | :-- | :-- |
|  |  | Order | Ord + Greedy | Rank | Rank + Greedy |
| 10.42 | 0.1 | 2365.4 | 2147.8 | 26.0 | 26.2 |
| 10.73 | 0.1 | 2372.9 | 2365.3 | 24.2 | 25.7 |
| 15.42 | 0.1 | 2445.9 | 2394.1 | 34.5 | 32.4 |
| 15.73 | 0.1 | 2375.6 | 2404.2 | 35.5 | 36.2 |
| 20.42 | 0.2 | 2411.4 | 2348.4 | 47.8 | 48.7 |
| 20.73 | 0.2 | 2223.9 | 2387.4 | 48.2 | 50.8 |
| 25.42 | 0.2 | 2338.1 | 2452.5 | 59.4 | 58.9 |
| 25.73 | 0.2 | 2397.3 | 2657.6 | 47.3 | 60.3 |
| 30.42 | 0.2 | 2375.9 | 2553.7 | 61.9 | 69.1 |
| 30.73 | 0.2 | 2138.3 | 2611.0 | 56.0 | 67.4 |

Finally, we show in Fig. 4 a visualization of three solutions found by the greedy heuristic, CEGO-order and UMM-rank, the two last ones starting from the greedy solution. In each plot, the legend shows the order in which asteroids are visited (from top to bottom), the epoch at which an impulse was applied to change orbit, and the arrival epoch at each asteroid. Solid lines indicate either parking or transfer orbits. When the impulse and arrival epochs coincide, the parking time at the previous orbit was zero and no parking orbit is shown. Earth's orbit is shown as a dashed blue line and the Sun's position as a yellow point. Distances are shown at scale.
![img-3.jpeg](img-3.jpeg)
(c) UMM-rank + Greedy.

Fig. 4. Example solutions for instance 10.73.

# 6 Conclusions 

We have proposed in this paper a realistic benchmark for evaluating algorithms designed to tackle expensive black-box optimization problem in permutation space. The results highlight already some limitations of the evaluated algorithms. First, although CEGO consistently obtains better results than UMM as long as the right choice of representation is made, this comes at a cost of 100 times more computation time. Second, without any additional information, very rarely

either algorithm is able to match the quality of the solution found by a greedy approach, suggesting that their results are far from optimal. Finally, only CEGO makes some use of the information provided by a good initial solution, whereas UMM is very rarely able to improve over it.

Future work should evaluate other black-box algorithms for permutation problems in the ARP. Improvements to CEGO and UMM to make better use of good initial solutions would also be welcome. In fact, it is possible to generate multiple greedy solutions that may be used as starting points by the black-box optimizers. Finally, we plan to change the optimizer of the inner problem from the current deterministic SLSQP to a stochastic one, which changes the context of the outer problem from a deterministic permutation problem to a stochastic one. Under such context, a black-box optimizer for the outer problem must decide whether it is worth evaluating again already seen permutation in the hope that a new evaluation may further improve the objective function.

Reproducibility. Datasets and source code for reproducing the experiments reported are available from https://doi.org/10.5281/zenodo. 5725837.

Acknowledgement. This work is partially funded by the Universidad de Málaga, Consejería de Economía y Conocimiento de la Junta de Andalucía and FEDER (grant UMA18-FEDERJA-003) and MCIN/AEI/10.13039/501100011033 (grant PID 2020116727RB-I00). Thanks to the Supercomputing and Bioinnovation Center (SCBI) of the University of Málaga for their provision of computational resources and support. M. López-Ibáñez is a "Beatriz Galindo" Senior Distinguished Researcher (BEAGAL 18/00053) funded by the Spanish Ministry of Science and Innovation (MICINN).

# References 

1. Bartz-Beielstein, T., Zaefferer, M.: Model-based methods for continuous and discrete global optimization. Appl. Soft Comput. 55, 154-167 (2017). https://doi. org/10.1016/j.asoc. 2017.01.039
2. Cano Rodríguez, J.L., et al.: poliastro: astrodynamics in Python. Zenodo (2015). https://doi.org/10.5281/zenodo. 174
3. European Space Agency: Hera Mission. https://wwww.esa.int/Safety_Security/ Hera/Hera (2019). Accessed 22 Nov 2021
4. European Space Agency: Science \& Exploration: Asteroids. https://www.esa. int/Science_Exploration/Human_and_Robotic_Exploration/Exploration/Asteroids (2021). Accessed 22 Nov 2021
5. Goldstein, H.: Classical Mechanics. Addison-Wesley (1980)
6. Irurozki, E., López-Ibáñez, M.: Unbalanced mallows models for optimizing expensive black-box permutation problems. In: Proceedings of GECCO (2021). https:// doi.org/10.1145/3449639.3459366
7. Izzo, D.: Revisiting Lambert's problem. arXiv 1403.2705 [astro-ph.EP] (2014)
8. Knowles, J., Corne, D., Reynolds, A.: Noisy multiobjective optimization on a budget of 250 evaluations. In: Ehrgott, M., Fonseca, C.M., Gandibleux, X., Hao, J.-K., Sevaux, M. (eds.) EMO 2009. LNCS, vol. 5467, pp. 36-50. Springer, Heidelberg (2009). https://doi.org/10.1007/978-3-642-01020-0_8

9. Cáceres, L.P., López-Ibáñez, M., Stützle, T.: Ant colony optimization on a limited budget of evaluations. Swarm Intell. 103-124 (2015). https://doi.org/10.1007/ s11721-015-0106-x
10. Virtanen, P., et al.: SciPy 1.0: fundamental algorithms for scientific computing in Python. Nat. Meth. 17, 261-272 (2020). https://doi.org/10.1038/s41592-019-0686-2
11. Zaefferer, M., Stork, J., Friese, M., Fischbach, A., Naujoks, B., Bartz-Beielstein, T.: Efficient global optimization for combinatorial problems. In: Proceedings of GECCO, pp. 871-878 (2014). https://doi.org/10.1145/2576768.2598282