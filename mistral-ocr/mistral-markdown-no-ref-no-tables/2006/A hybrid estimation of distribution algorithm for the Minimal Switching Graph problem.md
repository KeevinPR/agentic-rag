# A Hybrid Estimation of Distribution Algorithm for the Minimal Switching Graph Problem 

Maolin Tang<br>Faculty of Information Technology<br>Queensland University of Technology<br>2 George Street, Brisbane, Australia<br>m.tang@qut.edu.au

Raymond Y. K. Lau<br>Department of Information Systems<br>City University of Hong Kong<br>Tat Chee Avenue, Kowloon, Hong Kong<br>raylau@cityu.edu.hk


#### Abstract

Minimal Switching Graph (MSG) is a graphical model for the constrained via minimization problem - a combinatorial optimization problem in integrated circuit design automation. From a computational point of view, the problem is NP-complete. In this paper we present a new approach to the MSG problem using hybrid Estimation of Distribution Algorithms (EDAs). This approach uses a Univariate Marginal Distribution Algorithm (UMDA) to sample start search points and employs a hill-climbing algorithm to find a local optimum in the basins where the start search points are located. By making use of the efficient exploration of the UMDA and the effective exploitation of the hill-climbing algorithm, this hybrid EDA can find an optimal or nearoptimal solution efficiently and effectively. The hybrid EDA has been implemented and compared with the UMDA and the hill-climbing algorithm. Experimental results show that the hybrid EDA significantly outperforms both the UMDA and the hill-climbing algorithm.


## 1. Introduction

Minimal Switching Graph (MSG) is a graph-theoretic model for the constrained via minimization problem - a combinatorial optimization problem in integrated circuit design automation [1]. From a computational point of view, the problem is NP-complete [2].

Estimation of Distribution Algorithm (EDA) is a new paradigm of evolutionary computation. It was introduced into the field of evolutionary computation for the first time by Mühlenbein and Paaß in 1996 [3]. In EDAs there is neither crossover nor mutation operator. New population is generated by sampling the probability distribution, which is estimated from a database containing selected individuals from previous generation. In EDAs the problem specific in-
teractions among the variables of individuals are expressed explicitly through the joint probability distribution associated with the variables in the selected individuals.

Different approaches have been proposed for the estimation of probability distribution. One of the approaches is the Univariate Marginal Distribution Algorithm (UMDA) introduced by Mühlenbein in 1998 [4]. The pseudocode for the UMDA is as follow:

1. randomly generate M individuals (the initial population) and store them in $D_{0}$;
2. $\mathrm{g}=1$;
3. while the stopping criterion has not met
(a) select $N \leq M$ individuals from $D_{g-1}$ according to the selection method and store them in $D_{g-1}^{S}$;
(b) estimate the joint probability distribution using $p_{g}(x)=p\left(x \mid D_{g-1}^{S}\right)=\prod_{i=1}^{n} p_{g}\left(x_{i}\right)=$ $\prod_{i=1}^{n} \frac{\sum_{i=1}^{N} \delta_{j}\left(X_{i}=x_{i} \mid D_{g-1}^{S}\right)}{N}$;
(c) sample M individuals (the new population) from $p_{g}(x)$.
where
$\delta_{j}\left(X_{i}=x_{i} \mid D_{g-1}^{S}\right)= \begin{cases}1, & \text { if in the } j^{t h} \text { case of } D_{g-1}^{S}, \\ & X_{i}=x_{i} ; \\ 0, & \text { otherwise. }\end{cases}$
This paper presents a hybrid EDA for the MSG problem. The hybrid algorithm uses a UMDA to sample start search points and employs a hill-climbing algorithm to find a local optimum in the basins where the start search points are located. By making use of the efficient exploration of the UMDA and the effective exploitation of the hillclimbing algorithm, this hybrid EDA can find an optimal or near-optimal solution efficiently and effectively. The hybrid EDA has been implemented and compared with both

![img-0.jpeg](img-0.jpeg)

Figure 1. A directed bigraph
the UMDA and the hill-climbing algorithm. Experimental results show that the performance of the hybrid EDA is significantly better than that of the UMDA and the hillclimbing algorithm.

The remaining paper is organized as follows. In Section 2 the MSG problem is formalized. Then an encoding scheme for the MSG problem, which is used by the algorithms, is presented in Section 3. Section 4 and Section 5 present the UMDA and the hill-climbing algorithm respectively. Section 6 elaborates the hybrid EDA. Empirical comparisons between the hill-climbing algorithm, the UMDA and the hybrid EDA are conducted and experimental results are presented in Section 7. Finally we draw conclusions and discuss the hybrid EDA in Section 8.

## 2. The Minimal Switching Graph Problem

A directed bigraph is a directed graph whose vertices can be partitioned into two disjoint sets such that no vertices within the same set are adjacent. A directed bigraph can be denoted by $G=\left(V_{1} \cup V_{2}, E\right)$, where $V_{1}$ and $V_{2}$ are two disjoint vertex sets, and $E$ is a set of directed edges, or arcs. Figure 1 shows a directed bigraph, where $V_{1}=\left\{v_{11}, v_{12}, v_{13}, v_{14}, v_{15}, v_{16}, v_{17}\right\}, V_{2}=$ $\left\{v_{21}, v_{22}, v_{23}, v_{24}, v_{25}, v_{26}\right\}$, and $E=\left\{<v_{11}, v_{21}>,<\right.$ $\left.v_{11}, v_{22}>,<v_{25}, v_{12}>,<v_{23}, v_{13}>,<v_{24}, v_{13}>,<\right.$ $\left.v_{13}, v_{25}>,<v_{26}, v_{13}>,<v_{22}, v_{14}>,<v_{14}, v_{24}>,<\right.$ $\left.v_{14}, v_{25}>,<v_{15}, v_{22}>,<v_{26}, v_{16}>,<v_{17}, v_{21}>\right\}$.

A directed bigraph $G$ can be represented in a matrix $M$ defined in Equation 1.

$$
M=\left[\begin{array}{cccc}
a_{11} & a_{12} & \cdots & a_{1\left|V_{2}\right|} \\
a_{21} & a_{22} & \cdots & a_{2\left|V_{2}\right|} \\
\cdots & \cdots & \cdots & \cdots \\
a_{\left|V_{1}\right| 1} & a_{\left|V_{1}\right| 2} & \cdots & a_{\left|V_{1} V_{2}\right|}
\end{array}\right]
$$

where

$$
a_{i j}= \begin{cases}1, & \text { if }<v_{i}, v_{j}>\in E, v_{i} \in V_{1}, \text { and } v_{j} \in V_{2} \\ -1, & \text { if }<v_{i}, v_{j}>\in E, v_{i} \in V_{2}, \text { and } v_{j} \in V_{1} \\ 0, & \text { otherwise }\end{cases}
$$

For example, the directed bigraph shown in Figure 1 is represented by the following matrix:
![img-1.jpeg](img-1.jpeg)

Figure 2. A switching graph

$$
M=\left[\begin{array}{cccccc}
1 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & -1 & 0 \\
0 & 0 & -1 & -1 & 1 & -1 \\
0 & -1 & 0 & 1 & 1 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & -1 \\
1 & 0 & 0 & 0 & 0 & 0
\end{array}\right]
$$

Given a directed bigraph $G$, a switching graph of $G$, denoted by $G(S)$, is defined as the directed graph obtained by reversing the direction of all the arcs being incident to the vertices in $S \subseteq V_{1}$. Figure 2 displays a switching graph of $G, G\left(\left\{v_{13}, v_{16}\right\}\right)$.

The corresponding matrix representation of a switching graph $G(S)$ can be obtained from the matrix representation of $G$ through multiplying all values in the corresponding rows of $S$ by -1 . For switching graph $G\left(\left\{v_{13}, v_{16}\right\}\right)$, the corresponding matrix representation can be obtained through multiplying the values in the $3^{\text {rd }}$ and $6^{\text {th }}$ by -1 as below:

$$
M=\left[\begin{array}{cccccc}
1 & 0 & 1 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & -1 & 0 \\
0 & 0 & 1 & 1 & -1 & 1 \\
0 & -1 & 0 & 1 & 1 & 0 \\
0 & 1 & 0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 & 0 & 1 \\
1 & 0 & 0 & 0 & 0 & 0
\end{array}\right]
$$

It is pointed out that a directed bigraph $G$ itself is a special switching graph of $G$ in which $S=\phi$. A directed bigraph $G=\left(V_{1} \cup V_{2}, E\right)$ has $2^{\left|V_{1}\right|}$ switching graphs.

The vertices in $V_{2}$ are categorized into two types: desirable vertices and undesirable vertices. Desirable vertices are those vertices whose either in-degree or out-degree is zero, and undesirable vertices are those vertices whose both in-degree and out-degree are not zero. Desirable and undesirable vertices can be easily counted from the corresponding matrix representation. If a vertex is desirable vertex if and only if all non-zero values in the corresponding column are either all 1 or all -1 (not both); otherwise, the vertex is a undesirable vertex.

Given a directed bigraph $G$, the objective is to find a switching graph $G(S)$ such that the number of desirable vertices is maximal. This is so-called MSG problem.

## 3. Encoding Scheme for the MSG Problem

Suppose $G=\left(V_{1} \cup V_{2}, E\right)$ is a directed bigraph, and $G(S)$ is a switching graph of G. Let $m=\left|V_{1}\right|$ and $n=$ $\left|V_{2}\right|$. Then, a switching graph $G(S)$ can be represented as a sequence of $m$ bits, $x_{1} x_{2} \cdots x_{m}$, where

$$
x_{i}= \begin{cases}1, & \text { if } v_{i} \in S \\ 0, & \text { otherwise }\end{cases}
$$

and $1 \leq i \leq n_{1}$.
For example, the switching graph $G\left(\left\{v_{13}, v_{16}\right\}\right)$ shown in Figure 2 is encoded as 0010010 , and $G=G(\phi)$ is encoded 0000000 . In the hill-climbing algorithm, the UMDA and the hybrid EDA, a solution (switching graph) is encoded by such a sequence.

Given an MSG problem represented by the matrix $M_{\left|V_{1}\right| \times\left|V_{2}\right|}$, there is a one-to-one correspondence between the switching graphs and the set of binary strings of $m$ bits.

The fitness value of $x_{1} x_{2} \cdots x_{m}$ is defined in Equation 2.

$$
f\left(x_{1} x_{2} \cdots x_{m}\right)=\left|V_{d}\right|
$$

In the above equation, $V_{d}$ is the set of the desirable vertices in the corresponding switching graph $G(S)$. This fitness function is used by the hill-climbing algorithm, the UMDA, and the hybrid EDA presented in the following sections.

## 4. The Hill-Climbing Algorithm

Given an MSG problem $G$, the hill-climbing algorithm starts its search from the switching graph $G(\phi)$, and iteratively explores the neighboring switching graphs of the current switching graph one by one to see if it is better than the current one. If it is, then the current switching graph is replaced by the neighboring switching graph. The search process is repeated until no better switching graph can be found. The final switching graph is the solution to the MSG problem.

According to the encoding scheme, the starting switching graph $G(\phi)$ is encoded in $00 \cdots 0$. The neighboring switching graphs of a switching graph $x_{1} x_{2} \cdots x_{m}$ are those switching graphs whose Hamming distance to the switching graph is 1 . The Hamming distance between two switching graphs $x_{1}^{1} x_{2}^{1} \cdots x_{m}^{1}$ and $x_{1}^{2} x_{2}^{2} \cdots x_{m}^{2}$ is defined in Equation 3.

$$
H\left(x_{1}^{1} x_{2}^{1} \cdots x_{m}^{1}, x_{1}^{2} x_{2}^{2} \cdots x_{m}^{2}\right)=\sum_{i=1}^{m}\left|x_{i}^{1}-x_{i}^{2}\right|
$$

A switching graph $x_{1} x_{2} \cdots x_{m}$ has $m$ neighbors, $\overline{x_{1}} x_{2} \cdots x_{m}, x_{1} \overline{x_{2}} \cdots x_{m}, \cdots, x_{1} x_{2} \cdots \overline{x_{m}}$.

The description of the hill-climbing algorithm is as below. The input of the algorithm is a directed bigraph $G$ represented as a matrix $M$, and the output is a switching graph $G(S)$ of $G$, which is also represented by a matrix.

1. set current search point $x=00 \cdots 0$;
2. use $M$ to calculate the total number of desirable vertices in $x, d_{x}$;
3. improved $=$ true;
4. while (improved $=$ true) do
(a) improved $=$ false;
(b) for each of the neighbors of $x, x^{n}$ :
i. get the corresponding matrix of $x^{n}, M^{n}$;
ii. use $M^{n}$ to calculate the total number of desirable vertices in $x^{n}, d_{x_{n}}$;
iii. if $d_{x_{n}}>d_{x}$, then
A. $x=x^{n}$
B. $d_{x}=d_{x_{n}}$;
C. improved $=$ true;
D. go to (a) ;
5. output the corresponding matrix of $x$.

The hill-climbing algorithm is a local optimization algorithm. It can exploit the information about the current search point effectively. However, the search may be trapped at a local optimum.

## 5. The Univariate Marginal Distribution Algorithm

Given an MSG problem $G$, the UMDA starts with randomly generating an initial population of PopSize individuals, each of which is encoded in a binary string of $\left|V_{1}\right|$ bits, by sampling the probability distribution: $p_{0}=\prod_{i=1}^{V_{1}}$, where $p_{0}\left(X_{i}\right)=0.5$ for $i=1,2, \cdots,\left|V_{1}\right|$. Thus, the joint probability distribution is factorized as a product of $\left|V_{1}\right|$ univariate marginal probability distributions, each of which follows Bernouilli distribution with parameter value equaling to 0.5 .

Once the initial population is created, the UMDA starts evolving the population for Gen generations. In each generation, the best PopSize/2 individuals are selected from the population and the selected individuals are characterized using the joint probability distribution

$$
p_{g}(x)=p\left(x \mid D_{g-1}^{S}\right)=\prod_{i=1}^{n} p_{g}\left(x_{i}\right)
$$

$$
=\prod_{i=1}^{n} \frac{\sum_{i=1}^{N} \delta_{j}\left(X_{i}=x_{i} \mid D_{g-1}^{S}\right)}{N}
$$

Then, a new population is obtained by sampling the joint probability $p_{g}(x)$. The selecting, learning and sampling process is repeated for Gen times to produce a satisfactory switching graph.

The UMDA is described as below:

1. randomly generate PopSize individuals (the initial population) and store them in $D_{0}$;
2. for $g=1$ to Gen:
(a) select the best PopSize/2 individuals from $D_{g-1}$ and store them in $D_{g-1}^{S}$;
(b) estimate the joint probability distribution using $p_{g}=p\left(x \mid D_{g-1}^{S}\right)=\prod_{i=1}^{n} p_{g}\left(x_{i}\right)=$ $\prod_{i=1}^{n} \frac{\sum_{i=1}^{N} \delta_{j}\left(X_{i}=x_{i} \mid D_{g-1}^{S}\right)}{N}$;
(c) sample PopSize individuals from $p_{g}(x)$.

In the above algorithm,
$\delta_{j}\left(X_{i}=x_{i} \mid D_{g-1}^{S}\right)= \begin{cases}1, & \text { if in the } j^{\text {th }} \text { case of } D_{g-1}^{S}, \\ & X_{i}=x_{i} ; \\ 0, & \text { otherwise. }\end{cases}$

## 6. The Hybrid of the UMDA and the HillClimbing Algorithm

The hybrid EDA uses the UMDA to sample start search points and employs the hill-climbing algorithm to find a local optimum in the basins where the start search points are located. By making use of the efficient exploration of the UMDA and the effective exploitation of the hill-climbing algorithm, this hybrid EDA can find an optimal or nearoptimal solution efficiently and effectively.

The hybrid EDA is as follow:

1. randomly generate PopSize individuals (the initial population) and store them in $D_{0}$;
2. use the hill-climbing algorithm to optimize the individuals in the population;
3. for $g=1$ to Gen:
(a) select the best PopSize/2 individuals from $D_{g-1}$ and store them in $D_{g-1}^{S}$;
(b) estimate the joint probability distribution using $p_{g}(x)=p\left(x \mid D_{g-1}^{S}\right)=\prod_{i=1}^{n} p_{g}\left(x_{i}\right)=$ $\prod_{i=1}^{n} \frac{\sum_{i=1}^{N} \delta_{j}\left(X_{i}=x_{i} \mid D_{g-1}^{S}\right)}{N}$;
(c) sample PopSize individuals from $p_{g}(x)$;
(d) use the hill-climbing algorithm to optimize the individuals in the population.

## 7 Empirical Comparisons between the HillClimbing Algorithm, the UMDA and the Hybrid EDA

The hill-climbing algorithm, the UMDA and the hybrid EDA have been implemented in $C \#$. In order to perform fair comparisons, we have developed a program to randomly generate SMG test problems. The program takes two parameters, $\left|V_{1}\right|$ and $\left|V_{2}\right|$, and generates a bigraph $G=\left(V_{1} \cup V_{2}, E\right)$. The program firstly generates two vertex sets $V_{1}$ and $V_{2}$. Then, for each of the vertex $v$ in $V_{2}$ the program generates a degree $d(v)$, where $2 \leq d(v) \leq 4$, and then randomly generates $d(v)$ directed edges associated with $v$.

Using the program we have generated 20 test problems. When we generated the 20 test problems using the program, we set the first parameter $\left|V_{1}\right|=100$, and the second parameter $\left|V_{2}\right|$ from 50 to 145 with increment of 5 . Thus, for all the randomly generated test problems the search spaces are all $2^{100}$, but the numbers of local optima are different. Generally, the more mutual constraints among the vertices in $V_{1}$ in a test problem, the more local optima the test problem has, and the more challenging the test problems is (it is more likely trapped in a local optimum). The characteristics of the randomly generated test problems are shown in Table 1. In the table, $\left|V_{1}\right|$ and $\left|V_{2}\right|$ represent the number of vertices in $V_{1}$ and $V_{2}$ respectively, and $\left|V_{n}\right|$ is the number of undesirable vertices.

We have tested the three implemented algorithms on the test problems. For each of the test problems, we use the hill-climbing algorithm, the UMDA, and the hybrid EDA to optimize it, and we record the solutions. For the UMDA and the hybrid EDA, we run them for 60 seconds for each of the test problems. The population sizes used by the UMDA and EDA are both 100. The hill-climbing algorithm outputs its solution when the search converges. The test results are shown in Table 2. In the table, the number of undesirable vertices $\left|V_{n}\right|$ in the test problem is displayed in the second column. The number of undesirable vertices after optimization, together with the reduction of undesirable vertices in percentage, for each of the algorithms, are also presented. All the experiments are performed in a computer which has an Intel Pentium M 1000MHz CPU with 768MB of RAM.

It can be seen from the test results that the hybrid EDA always generates better results than the UMDA and the hill-climbing algorithm except for the second test problem which the hybrid EDA produces a result that is as good as that of the hill-climbing algorithm but is better than that of the UMDA. The statistic data show that the hillclimbing algorithm, the UMDA and the hybrid EDA can reduce the number of undesirable vertices by $68.36 \%, 64.18 \%$ and $75.15 \%$, respectively. In other word, overall the hybrid EDA outperforms the hill-climbing algorithm and the

Table 1. The characteristics of the test problems

Table 2. Comparisons of the hill-climbing algorithm, the UMDA and the hybrid EDA
UMDA by $6.79 \%$ and $10.97 \%$, respectively, for the test problems.

## 8 Conclusion and Discussion

In this paper we have presented a new approach to the MSG problem using hybrid EDAs. This approach uses a UMDA to sample start search points and employs a hillclimbing algorithm to find a local optimum in the basins where the start search points are located. By making use of the efficient exploration of the UMDA and the effective exploitation of the hill-climbing algorithm, this hybrid EDA can find an optimal or near-optimal solution efficiently and effectively.

In order to test the performance of the hybrid EDA, we have implemented the hybrid EDA, the UMDA and the hillclimbing algorithm, and have done empirical comparisons between the three algorithms for 20 randomly generated SMG problems of the same size, but of different levels of mutual constrains. Experimental results have shown that the performance of the hybrid EDA is significantly better than both of the UMDA and the hill-climbing algorithm.

The performance of the hybrid EDA could be further improved by two means. Firstly, the joint probability distribution could be factorized by a more sophisticated model reflecting the linkage among those variables [5]. For example, the Factorized Distribution Algorithm (FDA) [6] might be applied on the MSG problem and might produce better results. Secondly, incorporation of domain-specific knowledge into the hybrid EDA could also contribute to improvement of the performance of the hybrid EDA.
