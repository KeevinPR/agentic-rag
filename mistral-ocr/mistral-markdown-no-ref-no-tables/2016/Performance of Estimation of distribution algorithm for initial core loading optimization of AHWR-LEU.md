# Performance of Estimation of distribution algorithm for initial core loading optimization of AHWR-LEU 

Amit Thakur ${ }^{\mathrm{a}, *}$, Baltej Singh ${ }^{\mathrm{a}}$, Anurag Gupta ${ }^{\mathrm{a}}$, Vibhuti Duggal ${ }^{\mathrm{b}}$, Kislay Bhatt ${ }^{\mathrm{b}}$, P.D. Krishnani ${ }^{\mathrm{a}}$<br>${ }^{a}$ Reactor Physics Design Division, Bhabha Atomic Research Centre, Mumbai 400085, India<br>${ }^{\mathrm{b}}$ Computer Division, Bhabha Atomic Research Centre, Mumbai 400085, India

## A R T I C L E I N F O

Article history:
Received 9 October 2015
Received in revised form 4 February 2016
Accepted 27 May 2016
Available online 20 June 2016

Keywords:
Core reloading
Loading pattern optimization (LPO)
Initial core
Evolutionary algorithm
Genetic algorithm

## A B S T R A C T

Population based evolutionary algorithms now form an integral part of fuel management in nuclear reactors and are frequently being used for fuel loading pattern optimization (LPO) problems. In this paper we have applied Estimation of distribution algorithm (EDA) to optimize initial core loading pattern (LP) of AHWR-LEU. In EDA, new solutions are generated by sampling the probability distribution model estimated from the selected best candidate solutions. The weighing factor ' $x$ ' decides the fraction of current best solution for updating the probability distribution function after each generation. A wider use of EDA warrants a comprehensive study on parameters like population size, weighing factor ' $x$ ' and initial probability distribution function. In the present study, we have done an extensive analysis on these parameters (population size, weighing factor ' $x$ ' and initial probability distribution function) in EDA. It is observed that choosing a very small value of ' $x$ ' may limit the search of optimized solutions in the near vicinity of initial probability distribution function and better loading patterns which are away from initial distribution function may not be considered with due weightage. It is also observed that increasing the population size improves the optimized loading pattern, however the algorithm still fails if the initial distribution function is not close to the expected optimized solution. We have tried to find out the suitable values for ' $x$ ' and population size to be considered for AHWR-LEU initial core loading pattern optimization problem. For sake of comparison and completeness, we have also addressed the initial core optimization of AHWR-LEU by using Genetic algorithm (GA). In GA too, similar dependence on population size and initial distribution function is observed. However, by increasing the population size, the results in GA optimization improved drastically.
(c) 2016 Elsevier Ltd. All rights reserved.

## 1. Introduction

Indian Advanced Heavy Water Reactor (AHWR) (Sinha and Kakodar, 2006; Kakodkar, 1998) is being designed as a 300 MWe ( 920 MWth) Thorium based reactor with light water coolant and heavy water moderator. The basic fuel cycle of AHWR is based on (Th, U) MOX and (Th, Pu) MOX based fuel which is self sufficient in $U$ and requires external feed of Plutonium. An alternate fuel cycle for AHWR known as AHWR-LEU (www.dae.gov.in/gc/ahwr-leu-broc.pdf; Thakur et al., 2011) is also being designed, where the fuel cycle is based on Thorium and Low enriched Uranium based (LEU) MOX fuel in open cycle mode. AHWR-LEU is 300 MWe ( 920 MWth) vertical reactor with a discharge burn-up of $60 \mathrm{GWd} / \mathrm{Te}$ in once through fuel cycle mode. The LEU being considered consists of $19.75 \%$ U-235 and $80.25 \%$ U-238. The average

[^0]U-235 content in equilibrium core cluster of AHWR-LEU is about $4.29 \%$. On-power refueling, negative coolant void reactivity and heat removal through natural circulation are salient features of AHWR/AHWR-LEU. In our earlier work (Thakur et al., 2013), the various issues related to in-core fuel management of AHWR-LEU were addressed. A special refueling scheme for facilitating onpower refueling with high discharge burn-up fuel in AHWR-LEU equilibrium core was discussed.

Loading of equilibrium core cluster in initial core of AHWR-LEU will necessitate the requirement of large quantity of poison (Boron) in the moderator to suppress initial excess reactivity. The large quantity of Boron dissolved in moderator will adversely affect the worth of control and shut down system in addition to its adverse effect on various reactivity feedbacks. Therefore, the initial core clusters for AHWR are being designed to have lesser excess reactivity. For flux flattening in initial core of AHWR-LEU, two fuel clusters with differential reactivity have been considered. The cluster with more reactivity is named as Type-1 and with lesser


[^0]:    * Corresponding author.

    E-mail address: thakur@harc.gov.in (A. Thakur).

reactivity is called as Type-2. The AHWR-LEU core consists of 444 fuel lattice locations. By exploiting symmetry of the core, the problem size for AHWR-LEU initial core optimization reduces to $2^{62}$ $\left(\sim 10^{16}\right)$. Simulation of all these loading patterns is not practical in a finite time scale to choose the best loading pattern. The optimization of initial core of AHWR-LEU is a complex combinatorial optimization problem. Population based algorithms are frequently being used for fuel loading pattern optimization problem. Genetic algorithm (GA) (Goldberg, 1989; Parks, 1996; Chapot et al., 1999), simulated annealing (SA) (Stevens et al., 1995) and Ant Colony Algorithm (ACO) (Machado and Schirru, 2002) are few examples of population based evolutionary algorithms which have been successfully applied for core reloading optimization problems of Pressurized water reactors (PWRs). Estimation of distribution algorithm (EDA) (Jiang et al., 2006) has been applied successfully to CONSORT research reactor where five different types of fuels are to be loaded in 24 locations with the objective of maximization of $k$-effective. The typical size in this problem is $\sim 10^{12}$. Jiang et al. has considered a population size of 50 in each generation along with a very small value of weighing factor ' $\alpha$ ' ( 0.001 ). It is also observed that Jiang et al. has carried out more than 2000 generations. It is only possible because the objective function considered is maximization of $k$-effective only. And the prediction of $k$ effective is done by Artificial neural network (ANN) (Jiang et al., 2006). By using ANN, a large number of loading patterns can be analyzed for $k$-effective values in very short time. Mishra et al., 2009 has successfully applied EDA to initial core loading optimization of Pressurized heavy water reactors (PHWRs). The problem size in this problem is $\sim 10^{65}$. They have tried to find the optimized loading pattern with fixed number of Th or depleted U fuel bundles. They have defined objective function based on penalty method and have also used EDA for optimization of initial core of PHWR. Due to the complexity of objective function, a full 3D diffusion calculations are required and which necessitate the use of parallel processing. Mishra et al. (2009) have used earlier experience of (Balakrishnan and Kakodkar, 1994) for fixing the number of Thorium bundles between 18 and 36 and they have tried to search the optimization between these 18 and 36 Thorium bundles. It is also observed (Mishra et al., 2009) that the optimized loading pattern with lower population is better than the optimized loading pattern with higher population size in some cases. In their analysis, they have considered same value of weighing factor ' $\alpha$ ' ( 0.05 ) for all the population sizes. In the optimization analysis presented in this paper, we have applied EDA to optimize initial core of AHWR-LEU and it is observed that the optimization results are very sensitive to weighing factor ' $\alpha$ ' and population size of each generation. It is also observed that while choosing a very small value of weighing factor ' $\alpha$ ' with large population size algorithm may lead to unnecessary computations and may not always lead to a good optimized loading pattern.

The main focus in this paper is to optimize the initial core of AHWR-LEU using Estimation of distribution algorithm (EDA). During this study it was observed that EDA itself is very sensitive to the various parameters used for updating the probability distribution function after each generation. An extensive study was done to determine adequate parameters used in EDA for better optimized loading pattern. The outcomes of this study are then backed by addressing the same initial core loading optimization of AHWRLEU using Genetic algorithm considering different population sizes.

We have studied the effect of variation of weighing factor ' $\alpha$ ', population size in each generation and initial distribution function on the final optimized loading pattern.

In this paper, we have tried to establish that considering a very small value of weighing factor ' $\alpha$ ' for any population size during each generation, results in search around local area only. Hence,
with increase in population size, value of weighing factor ' $\alpha$ ' should also be increased for better optimization. The plan of paper is as follows.

Section 2 gives the explanation of the initial core optimization problem for AHWR-LEU and the objective function considered. Section 3 gives the description of EDA and the various parameters used in this algorithm. Section 4 gives the numerical results for variation of weighing factor ' $\alpha$ ', population size and initial probability distribution function. Section 5 gives the description of GA and its application on AHWR-LEU core for different population sizes in each generation. Conclusions are discussed in Section 6.

## 2. AHWR-LEU initial core loading pattern optimization problem

The AHWR-LEU core consists of 513 lattice locations. Out of 513 , there are 444 fuel lattice locations. There are 45 shut off rods which constitute the primary shut down system (SDS-1). There are 24 control rods in form of 8 Regulating rods (RRs), 8 Shim rods (SRs) and 8 Absorber rods (ARs). The control and shut down devices are in the lattice locations of AHWR-LEU core. Two types of cluster are being considered for initial core of AHWR-LEU for flux flattening. Table 1 presents the core configuration of the AHWR-LEU core and Table 2 gives the description of initial core clusters considered for present study. Neutron Transport Theory computer code ITRAN (Krishnani, 1982a (pp. 255-260); Krishnani, 1982b (pp. 287-296)) has been used to perform the lattice calculations for the AHWR-LEU initial core clusters. The calculations were performed by using 69-group library based on ENDF-B VLB nuclear data obtained from IAEA (http://www-nds.iaea.org/ wimsd/). Two energy group cross sections for both the clusters were generated using ITRAN. Diffusion theory code FEMINA (Kumar and Srivenkatesan, 1984) based on nodal expansion method has been used to carry out the core level calculations using two group cross sections generated with ITRAN.

There are $2^{444}\left(\sim 10^{133}\right)$ different possible ways with which the two types of fuels can be loaded in the core. The quarter core symmetry reduces the number of combinations to $2^{111}\left(\sim 10^{33}\right)$. The problem size can be further reduced to $2^{62}\left(\sim 10^{18}\right)$ by exploiting 1/8th mirror symmetry of few channels as shown in Fig. 1. The complex objective function for initial core optimization has been defined as based on the following assumptions:-

Table 1
Description of the AHWR LEU reactor core.

Table 2
![img-0.jpeg](img-0.jpeg)

Fig. 1. Schematic of AHWR-LEU core.

1. $K$-effective is maximized.
2. Worth of Shut down system should be always greater than design requirement ( 63 mk ).
3. Maximum channel power (MCP) should be below the design limit of 2.6 MWth.
4. Maximum mesh power (MMP) should be below the design limit of 200 kWth.

This type of combinatorial optimization problem can be solved by defining an objective function and then maximizing it. Penalty method has been used to define the objective function in a similar way to Mishra et al., 2009.

The objective function (OF) for this problem is defined as

$$
\begin{aligned}
\mathrm{OF}= & A_{1} \cdot k \text {-eff }-A_{2} \cdot(\mathrm{MCP}-2 \cdot 6)-A_{3} \cdot(\mathrm{MMP}-200)-A_{4} \\
& \cdot(63.0 \text {-worth of SDS-1(43 rods) })
\end{aligned}
$$

where $A_{1}, A_{2}, A_{3}$ and $A_{4}$ are constants. The values of these constants are based on experience and requirements. In this optimization problem, the value of $A_{1}$ is taken as 1 . For optimization studies SDS-1 (43 rods, two maximum worth rods failure criteria) worth requirements of 63.0 mk have been considered.

Further, if MCP of a LP is $<2.6$, then $A_{2}=0$, else $A_{2}=0.384$.
Similarly, if MMP $<200$, then $A_{3}=0$, else $A_{3}=0.05$.
And worth of SDS-1 $>63.0$, then $A_{4}=0$, else $A_{4}=0.333$.
Hence, we are considering only the penalty due to design parameters not meeting their design limit, but we do not prefer any LP which is having very high margins in peaking or SDS-1
worth. The criteria are to maximize the $k$-effective without compromising full power operation and safety of reactor.

The AHWR initial core requires small amount of neutron poison ( 25 ppm of Boron) in moderator to compensate initial excess reactivity. Therefore, all the simulations have been considered with 25 ppm of B in moderator.

## 3. Estimation of distribution algorithm (EDA)

EDA is a population based evolutionary algorithm. The optimized solution is achieved by sampling the probability distribution model which is generated based on current best solutions. We start with an initial probability distribution function. After evaluation of the objective function value for all the candidates in the present sample, the probability distribution function is modified by giving some weight to current best solutions. Univariate marginal distribution algorithm (UMDA) (Jiang et al., 2006) has been used to estimate the probability distribution in present study. The description of this EDA is as given below:

Step-1 Generate a population $(N)$ of different loading patterns based on initial distribution function.
Step-2 Simulate all the candidates of this population by solving diffusion equation using FEMINA and Objective function for all the candidates is evaluated.
Step-3 Select best $M<N$ candidates based on objective function values.
In present study, $M$ is considered as $25 \%$ of $N$.
Step-4 The distribution function (DF) for generating loading pattern is modified.

$$
\mathrm{DF}(t+1)=\mathrm{DF}(t) \cdot(1-\alpha)+\alpha \cdot X
$$

where ' $\alpha$ ' (weighing factor) is a constant and its value is between 0 and 1. DF ( $t$ ) and $X$ are having same structure. ' $t$ ' represents the generation.

$$
\text { where } X=\frac{1}{M} \cdot \sum_{i=1}^{M} X_{i}(t)
$$

$X_{i}(t)$ is 0 or 1 based on the loading of a particular fuel in fuel lattice location.

Step-6 Again generate the population of different loading patterns based on new distribution function.
Step-7 Go to step-2 and repeat the cycle till optimization is achieved.

In our present study, two initial distribution functions have been used. As discussed earlier, the Type-2 fuel is less reactive than Type-1 fuel. It is evident that the optimized core will have more number of Type-1 fuel clusters than Type-2 fuel clusters. Hence, both the initial distribution functions should generate loading pattern with more number of Type-1 fuel cluster and less number of Type-2 fuel clusters. Following are the details of initial distribution function considered:
I. The distribution function is such that the loading pattern generated by it should have $\sim 60 \%$ of Type-1 fuel cluster and $\sim 40 \%$ of Type-2 fuel clusters.

II. The distribution function is such that the loading pattern generated by it should have $\sim 80 \%$ of Type-1 fuel cluster and $\sim 20 \%$ of Type-2 fuel clusters.

The loading patterns are generated using random numbers by following the criteria that for a channel if random number is less than 0.8 or 0.6 then Type-1 will be loaded else Type-2 will be loaded. Both the cases have been analyzed for three different population sizes (24, 240 and 1200) and three different values of ' $\alpha$ ' $(0.05,0.1$ and 0.5$)$. The distributed memory parallel computer system AGGRA at BARC was used for parallelization and computation of $N(24,240$ or 1200$)$ independent objective functions by running FEMINA.

## 4. Results of EDA on AHWR-LEU initial core loading pattern optimization

The study of varying initial distribution function has been divided into two parts as described above.

### 4.1. Case-I: Initial distribution function is 0.6 for type-1 and 0.4 for type-2

In this case the loading patterns are generated by generating random number for each fuel channel and setting the criteria that if the random number generated is less than 0.6 , type-1 cluster will be loaded else type-2 cluster will be loaded. In this way the type-1 clusters will be $\sim 60 \%$ and type-2 clusters will be $\sim 40 \%$. Now three different values of population sizes have been considered.

### 4.1.1. Case-I(a): Population size of 24 in each generation

The three values of $\alpha$ considered are $0.05,0.1$ and 0.5 . The first case of population size of 24 and $\alpha=0.05$ belongs to very small population size and very small ' $\alpha$ '. The best value of objective function in 400 generations is 0.9870 . After increasing the value of $\alpha$ to 0.1 , the best value of objective function in 400 generations improved to 0.98790 . By further increasing the value of $\alpha$ to 0.5 , the best value of objective function in 150 generations improves marginally to 0.9965 . The variation of best value of objective func-
tion with generation number for different values of $\alpha$, is shown in Fig. 2. It is observed that there is very small or negligible improvement in optimized value of objective function by increasing $\alpha$ from 0.05 to 0.5 .

### 4.1.2. Case-I(b): Population size of 240 in each generation

In the second step, we tried the simulations considering higher population size of 240 in each generation. The three values of $\alpha$ considered are $0.05,0.1$ and 0.5 . The first case of population size of 240 and $\alpha=0.05$ belongs to moderate population size and very small ' $\alpha$ '. The best value of objective function in $\sim 130$ generations is 0.9954 . After increasing the value of $\alpha$ to 0.1 , the best value of objective function in 130 generations improved to 1.0074 . By further increasing the value of $\alpha$ to 0.5 , the best value of objective function in 150 generations improves marginally to 1.009530 . The variation of best value of objective function with generation number for different values of $\alpha$, is shown in Fig. 3. On comparison with case-I(a), it is observed that there is significant improvement in optimized value of objective function. It is also observed that the very small value of $\alpha(0.05)$, the optimized value of objective function is poor (0.9954).

### 4.1.3. Case-I(c): Population size of 1200 in each generation

By further increasing the population size to 1200 in each generation and considering three values of $\alpha$ as $0.05,0.1$ and 0.5 , following observations were made. The first case of population size of 1200 and $\alpha=0.05$ belongs to large population size and very small ' $\alpha$ '. The best value of objective function in $\sim 130$ generations is 0.9955 . This value is comparable to case-I(a) and I(b) for $\alpha=0.05$. It means the algorithm still fails for $\alpha=0.05$. After increasing the value of $\alpha$ to 0.1 , the best value of objective function in 130 generations improved to 1.0079 . By further increasing the value of $\alpha$ to 0.5 , the best value of objective function in 150 generations improves marginally to 1.009530 . The variation of best value of objective function with generation number for different values of $\alpha$, is shown in Fig. 4.

It is evident from the above study that the population size of 24 is too small and the best optimized value of objective function in 400 generations is 0.9976 for $\alpha=0.05$. After increasing the popula-
![img-1.jpeg](img-1.jpeg)

Fig. 2. (Case-Ia) Variation of objective function with Generations for three values of $\alpha(0.05,0.1$ and 0.5$)$ for population size of 24 in each generation for initial distribution of 0.6 for type-1 and 0.4 for type-2.

![img-2.jpeg](img-2.jpeg)

Fig. 3. (Case-lb) Variation of objective function with generations for three values of $\alpha(0.05,0.1$ and 0.5$)$ for population size of 240 in each generation for initial distribution of 0.6 for type-1 and 0.4 for type-2.
![img-3.jpeg](img-3.jpeg)

Fig. 4. (Case-lc) Variation of objective function with generations for three values of $\alpha(0.05,0.1$ and 0.5$)$ for population size of 1200 considered in each generation for initial distribution of 0.6 for type-1 and 0.4 for type-2.
tion size from 24 to 240 or 1200 for same value of $\alpha=0.05$, there is very slight or negligible improvement in optimized value of objective function to 0.9936 and 0.9956 respectively.

However, after increasing the value of $\alpha$ to 0.1 , value of objective function improves to 1.0074 in 130 generations for population size of 240 and 1.0079 in 125 generations for population size of 1200. By further increasing the value of $\alpha$ to 0.5 , value of objective function improves to 1.009530 for both the population sizes of 240 and 1200. Hence, considering very small value of $\alpha(0.05)$ is not correct for AHWR-LEU initial core loading optimization problem.

By considering small value of $\alpha$, the optimized solution in near vicinity of initial guess distribution function is observed. Table 3 shows the results of case-I.
4.2. Case-II: Initial distribution function is 0.8 for type-1 and 0.2 for type-2

From our earlier experience (Thakur et al., 2010), we have observed that the optimized initial core of AHWR is having $\sim 20 \%$ type-2 clusters and $80 \%$ type-1 clusters. Hence a case is considered

Table 3
Properties of loading pattern optimized using EDA for variation of population size and $\alpha$ for initial distribution function of 0.6 for type-1 and 0.4 for type-2.

![img-4.jpeg](img-4.jpeg)

Fig. 5. (Case-IIa) Variation of objective function with generations for three values of $\alpha(0.05,0.1$ and 0.5$)$ for population size of 24 in each generation for initial distribution of 0.8 for type-1 and 0.2 for type-2.
where the initial distribution is $80 \%$ and $20 \%$ for type-1 and type-2 respectively. In this case the loading patterns are generated by generating random number for each fuel channel and setting the criteria that if the random number generated is less than 0.8 , type-1 cluster will be loaded else type-2 cluster will be loaded. In this way type-1 clusters will be $\sim 80 \%$ and type-2 clusters will be $\sim 20 \%$. Now three different values of population sizes have been considered similar to case-I.

### 4.2.1. Case-II(a): Population size of 24 in each generation

The three values of $\alpha$ considered are $0.05,0.1$ and 0.5 . The first case of population size of 24 and $\alpha=0.05$ belongs to very small population size and very small ' $\alpha$ '. The best value of objective function in 400 generations is 1.0040 . This is better value than 0.98704 observed with same $\alpha$ and population size but with different initial distribution function (Case-Ia). After increasing the value of $\alpha$ to 0.1 , the best value of objective function in 400 generations improved to 1.0044 . This value is again better value than 0.99536 observed with same $\alpha$ and population size but with different initial distribution function (Case-Ia). It shows that EDA gives significantly better optimization for small value of $\alpha$ and small population size (24), if the initial distribution function is closer to the optimized solution. By further increasing the value of $\alpha$ to 0.5 , the best value of objective function in 130 generations reduces
drastically to 0.9825 . This is worse value than 0.9965 observed with same $\alpha$ and population size but with different initial distribution function (Case-Ia). It is showing that the algorithm fails for population size of 24 and $\alpha=0.5$. This is because the population size is very small. The variation of best value of objective function with generation number for different values of $\alpha$, is shown in Fig. 5.

### 4.2.2. Case-II(b): Population size of 240 in each generation

The three values of $\alpha$ considered are $0.05,0.1$ and 0.5 . The first case of population size of 240 and $\alpha=0.05$ belongs to moderate population size and very small ' $\alpha$ '. The best value of objective function in $\sim 250$ generations is 1.0072 . This again is a better optimized value than case-I(b) where optimized value is only 0.9954 . After increasing the value of $\alpha$ to 0.1 , the best value of objective function in 130 generations improved to 1.00953 . By further increasing the value of $\alpha$ to 0.5 , the best value of objective function in 130 generations remains same as 1.00953 . The variation of best value of objective function with generation number for different values of $\alpha$, is shown in Fig. 6.

### 4.2.3. Case-II(c): Population size of 1200 in each generation

The three values of $\alpha$ considered are $0.05,0.1$ and 0.5 . The first case of population size of 1200 and $\alpha=0.05$ belongs to large population size and very small ' $\alpha$ '. The best value of objective function

![img-5.jpeg](img-5.jpeg)

Fig. 6. (Case-IIb) Variation of objective function with generations for three values of $\alpha(0.05,0.1$ and 0.5$)$ for population size of 240 in each generation for initial distribution of 0.8 for type-1 and 0.2 for type-2.
![img-6.jpeg](img-6.jpeg)

Fig. 7. (Case-IIc) Variation of objective function with generations for three values of $\alpha(0.05,0.1$ and 0.5$)$ for population size of 1200 in each generation for initial distribution of 0.8 for type-1 and 0.2 for type-2.
in $\sim 130$ generations is 1.0050 . After increasing the value of $\alpha$ to 0.1 , the best value of objective function in 130 generations improved to 1.00953. By further increasing the value of $\alpha$ to 0.5 , the best value of objective function in 130 generations remains same as 1.009530. The variation of best value of objective function with generation number for different values of $\alpha$, is shown in Fig. 7. Table 4 describes the results of case-II.

From comparison of Table 3 and Table 4, it is clear that for all the cases studied, the optimized value of objective function is better for case-II than corresponding case-I. Case-I \& II differ in respect
of initial distribution function only. It is observed that Case-I the algorithm completely failed for population size of 24 . However, we observed much better optimization in case-II for same population size of 24 . But in both the cases the best optimized value is not observed in this population size (24). Hence, it can be concluded that the population size of 24 is too small and is not correct for use in EDA on initial core LPO analysis of AHWR-LEU. Similarly, the small value of $\alpha=0.05$ has not resulted in best value of objective function for any case. Therefore, it can also be concluded that the value of $\alpha$ should be greater than 0.05 . For population size of

Table 4
Properties of loading pattern optimized using EDA for variation of population size and $\alpha$ for initial distribution function of 0.8 for type-1 and 0.2 for type-2.

![img-7.jpeg](img-7.jpeg)

Fig. 8. Variation of objective function with generations for two population sizes viz. 240 and 1200 for $\alpha=0.5$ in EDA and initial distribution of 0.6 for type-1 and 0.4 for type-2 as well as for initial distribution of 0.8 for type-1 and 0.2 for type-2.

240, best value of objective function is observed for $\alpha=0.1$ and 0.5 , however, the results are dependent on initial distribution function. For the case where $\alpha=0.5$ and population size is 1200 , same value (1.00953) of objective function is observed and there is no dependence on initial distribution fuction. The loading pattern corresponding to this value has 88 Type-2 clusters and 356 Type-1 clusters. The same optimized value of 1.009530 is observed for $\alpha=0.1$ and population size of 1200 and initial distribution function of 0.8 and 0.2 for type-1 and type-2 clusters. It shows that if our initial distribution function is near to optimized loading pattern, $\alpha=0.1$ is also adequate and minimum population size needed is 240. However, in no case, $\alpha=0.05$ has given an adequate optimization. Fig. 8 shows the variation of objective function with generations for two population sizes viz. 240 and 1200 for $\alpha=0.5$ initial distribution of 0.6 for type-1 and 0.4 for type-2 as well as for initial distribution of 0.8 for type-1 and 0.2 for type-2. It is observed that almost similar optimization is achieved in all the cases. However, the convergence is faster for the case where initial distribution of 0.8 for type-1 and 0.2 for type-2 is considered.

The behavior of average value of DF will give the information about how many type-1 and type-2 clusters will be there in next generation. In Fig. 9, the average value of DF has been plotted for all the cases studied. In Fig. 9a1, 9b1 and 9c1, the starting point is 0.6 . This is because initially we have uniformly filled 0.6 in all the 62 elements of DF. Now with each generation, individual values
of 62 elements of DF will vary. This will result in change in the average value of DF. Fig. 9a2, 9b2 and 9c2 represents the cases with initial DF of 0.8 for type-1 and 0.2 for type-2, therefore the starting value is 0.8 . From fig. 9a1 and 9a2, it is clear that the DF is not showing any improvement after $\sim 75$ generations for $\alpha=0.05$ and 0.1. It shows that the algorithm has failed. For $\alpha=0.5$, it has achieved a constant value. It means few elements of DF have become 1 and others have become 0 . Since the finalized solution does not show good parameters of an optimization, the algorithm has struck into local minima. From fig. 9b1 and 9b2, for $\alpha=0.05$ the algorithm has failed. For $\alpha=0.1$ and $\alpha=0.5$, it has progressed towards 0.8 value. It Shows that the optimized solutions achieved by population size of 240 and $\alpha=0.1$ or 0.5 will be better. From fig. 9c1 and 9c2, for $\alpha=0.05$ the average value of DF always remains near initial DF. For case with $\alpha=0.1$, the improvement in DF is very slow. However, for case with $\alpha=0.5$, the average value of DF approaches 0.8 even when initial DF is 0.6 .

## 5. Genetic algorithm applied to AHWR-LEU initial core loading pattern optimization

The use of Genetic Algorithm (GA) has been quite frequent for application to various nuclear reloading pattern optimization problems. They have been found to be very efficient and have

![img-8.jpeg](img-8.jpeg)

Fig. 9. Variation of average value of distribution function with generations for three population sizes (24, 240 and 1200) and three values of $x(0.05,0.1$ and 0.5$)$. Figures in the left side (a1, b1 and c1) are with initial distributions of 0.6 for type-1 and 0.4 for type-2. Figures in the right side (a2, b2 and c2) are with initial distributions of 0.8 for type1 and 0.2 for type-2. Fig. 9a1, 9a2 compares the results for population size of 24, Fig. 9b1, 9b2 compares the results for population size of 240 and Fig. 9c1, 9c2 compares the results for population size of 1200 .
always provided plausible solutions to complex combinatorial optimization problem. GA is also population based algorithm where optimized solution is evolved by selection of better candi-
date solutions and putting them in mating pool for recombination and generation of new candidates. In our work, we have used tournament selection (Ziver et al., 2004) method for generating

![img-9.jpeg](img-9.jpeg)

Fig. 10. Variation of objective function with generations for three population sizes viz. 24, 240 and 1200 for GA and initial distribution of 0.6 for type-1 and 0.4 for type-2.
the mating pool. And we have used uniform crossover operator for recombination in mating pool to generate the new candidates. A brief description of GA used is as given below:

Step-1 Generate a population $(N)$ of different loading patterns based on random initial distribution function.
Step-2 Simulate all the candidates of this population by solving diffusion equation using FEMINA and Objective function for all the candidates is evaluated.
Step-3 Two person tournament selection is done for creating the mating pool.
Step-4 New candidates of population size $N$ is generated by using uniform cross-over operator between different candidates of mating pool.

Step-5 Go to step-2 and repeat the cycle till optimization is achieved.

Three cases were considered with population size of 24, 240 and 1200 in each generation as in EDA. For each case, for generating the very first population set, two different initial distribution functions ( 0.6 for type-1 and 0.4 for type-2 as well as 0.8 for type1 and 0.2 for type-2) were considered similar to EDA studies. It is observed that similar to EDA case the algorithm fails for case with population size of 24 . For the cases with population size of 240 and 1200, the optimized value is 1.00953 for both the initial distribution functions. The same loading pattern is achieved with EDA. Figs. 10 and 11 shows the variation of objective function value for population size of 24,240 and 1200 for two different initial dis-
![img-10.jpeg](img-10.jpeg)

Fig. 11. Variation of objective function with generations for three population sizes viz. 24, 240 and 1200 for GA and initial distribution of 0.8 for type-1 and 0.2 for type-2.

Table 5
Properties of loading pattern optimized using GA for variation of population size for initial distribution function of 0.6 for type-1 and 0.4 for type-2.

Table 6
Properties of loading pattern optimized using GA for variation of population size for initial distribution function of 0.8 for type-1 and 0.2 for type-2.

![img-11.jpeg](img-11.jpeg)

Fig. 12. Core loading pattern of optimized core (1 and 2 represents type-1 and type. 2 clusters respectively) (S, SR, RR and AR shows the locations of SORs, Shim rods, Regulating rods and Absorber rods respectively).
tribution functions 0.6 for type-1 and 0.4 for type-2 as well as 0.8 for type-1 and 0.2 for type-2 respectively. Tables 5 and 6 gives the details of optimized loading patterns achieved using GA. Fig. 12 shows the best optimized loading pattern achieved with objective function value of 1.009530 .

## 6. Discussion and conclusions

In this work, an effort has been made to optimize the initial core of AHWR-LEU using EDA. While applying EDA it was observed, unlike in other optimization studies, (Mishra et al., 2009, Jiang et al., 2006) very small value (<0.05) of weighing factor ' $\alpha$ ' is not producing desired optimization. By considering a very small value of ' $\alpha$ ', the optimization is slowed and more solutions are explored to reduce the probability of falling in local minima. In our study we have found that the real optimization is happening only in the evolving region of the process. When the value of objective function saturates, the new patterns are generated only with the prob-
ability distribution function and the probability distribution function itself does not change much. Jiang et al. (2006) has also considered elitism or heuristic information to improve the results. In Jiang et al. (2006) it is concluded that simple EDA (named as EDA-S) without elitism or heuristic information the maximum value of objective function is lower than EDA with elitism or heuristic information (called as EDA-G and EDA-H). In our case of initial core optimization of AHWR-LEU, by using the general form of EDA (EDA-S) with small value of weighing factor ' $\alpha$ ' and small population size (24), the optimization was not achieved at all. However, we observed that the results can be improved by choosing adequate alpha and population size. It is also observed that for a small population size (24), although more generations (400) have been simulated, true optimization was not achieved. In case of larger population size, fewer generations are simulated and better optimization solutions are achieved. It is to be noted that considering a higher population size will increase the computational cost but it improves the results. It is observed that choosing small population size and small ' $\alpha$ ' is less computationally costly $(\sim 24-400=10,000$ simulations) but results are inferior. By having large population size ( 240 or 1200 ) and keeping small ' $\alpha$ '(0.05), computational cost is increased $(\sim 240-125=30,000$ or $1200-125=150,000$ simulations) and there is high probability that the optimized solution achieved will be near to initial distribution function (Fig. 9b1 and 9c1). The dependence on initial distribution function is reduced by increasing the value of ' $\alpha$ '. We have observed very good optimization for $\alpha=0.5$ and population size of 1200 . The results for $\alpha=0.5$ show convergence in less than 50 generations. This shows that the computational cost for this case ( $1200-50=60,000$ simulations) is almost six times of population size of $24(\alpha=0.05$ and 0.1$)$ and is about twice the case with population of $240(\alpha=0.05$ and 0.1$)$. The time for doing so many simulations in case of higher population cases may be reduced by increasing parallelization. In present study we could parallelize up to 600 CPUs. A significant decrease in computational time was observed due to this increased parallelization. The cases with population size of 240 and 1200 were although more computationally costly than case with population size of 24 but required less simulation time as we simulated fewer generations in higher population cases. In order to verify our results, we have addressed the same problem using GA. In GA too, it was observed that the algorithm has failed with population size of 24 . However, when the initial distribution function is near to optimized solution, the results are better. By increasing the population size to 240 or 1200, optimized loading pattern similar to EDA is achieved. It can also be concluded that for any optimization study using EDA, an adequate value of parameters used in the optimization algorithm should be obtained for the particular problem to enhance the performance of EDA.

## Acknowledgements

The authors are thankful to Dr. R. S. Modak, Ex. ThPD, BARC for discussions and constructive suggestions. The authors are also thankful to the referees for critically reviewing the manuscript.

## Web References

<www.dae.gov.in/gc/abwr-leu-broc.pdf>.
<http://www-nds.iaea.org/wimsd/>.