# An Estimation of Distribution Algorithm Guided by Mean Shift 

Hui Fang, Aimin Zhou, and Guixu Zhang<br>Shanghai Key Laboratory of Multidimensional Information Processing<br>Department of Computer Science and Technology<br>East China Normal University,500 Dongchuan Road, Shanghai, China<br>Email: 51151201029@stu.ecnu.edu.cn , \{amzhou,gxzhang\}@cs.ecnu.edu.cn


#### Abstract

The estimation of distribution algorithm is widely used to solve global optimization problems in recent years. The basic idea is using machine learning methods to extract relevant features of the search space among the selected individuals and to construct a probabilistic model for sampling new solutions. As we know, EDAs mainly focus on the global distribution information of population and are lack of solution location information. In this paper, we extend our previous work to propose a new EDA guided by the mean shift method, which is originally proposed as a density estimation method and is used as a local search method in this paper. In the new approach, at first a set of candidate solutions are generated by EDA. Then the mean shift method is used to refine some good parent solutions. Finally the sampled candidate solutions and the refined solutions are combined to form the offspring solutions. By this way, the global distribution information and the solution location information are used in offspring reproduction. We apply the new approach to a set of test instances and the experiment results indicate that the new algorithm can obtain good performance in most functions with a faster convergence rate.


Index Termsâ€”estimation of distribution algorithm, mean shift, local search, global optimization

## I. INTRODUCTION

In this paper, we consider the following box-constrained continuous global optimization problem.

$$
\begin{array}{ll}
\min & f(x) \\
\text { s.t. } & x \in \Omega
\end{array}
$$

where $x=\left(x^{1}, x^{2}, \cdots, x^{d}\right)^{T}$ is a decision variable vector, $\Omega=\left[a^{i}, b^{i}\right]^{d}$ is the feasible region of the decision space $\left(a^{i}<\right.$ $\left.b^{i}, a^{i} \in R\right.$ and $b^{i} \in R$ are the lower and upper boundaries of the decision space in the $i$ th dimension, respectively), $f(x)$ : $\Omega \rightarrow R$ is an objective function, and $R$ is the objective space.

There exists a variety of methods to deal with the global optimization problems. Among them, the evolutionary algorithms (EAs) [1] have been attracting much attention partly due to their weak assumptions on the optimization problem. Different EAs have been proposed, such as genetic algorithm (GA) [2], particle swarm optimization (PSO) [3], and different evolution(DE) [4]. Estimation of distribution algorithms (EDAs) [5] is another EA paradigm. Their major character is that they can produce new individuals by predicting the best search area through the search space sampling and statistical learning, while general EAs use crossover and mutation operators to generate new individuals.

In the main procedure of an EDA [6] [7], a probabilistic model is constructed first by extracting the global information from the population. Then new solutions are created by sampling from the probabilistic model. The concept of EDAs was first proposed in 1996 [5] and it has been developed rapidly in recent years. Different strategies have been applied to improve the performance of EDAs, such as probability model improvement [5], [8], population diversity maintaince [9], [10], hybrid EDA [11], [12], [13], [14], [15], [16], [17].

It is noted that EDAs pay more attention to the global distribution information of the population in offspring generation, whereas traditional EAs utilize crossover and/or mutation operators to generate offspring solutions, which pay more attention to the individual location information. An ideal algorithm should use both the two kinds of information. Following this idea, some algorithms have been proposed, such as the guided mutation [18], and the EDA and DE hybrid method [19].

Recently, we have also proposed an algorithm by combining EDA with expensive and cheap local search, denoted as EDA/LS [20], to improve the algorithm performance. The EDA part utilizes the global population distribution information, while the local search part utilizes the individual location information. In this paper, we propose an algorithm, named EDA/LS-MS, to find the optimal solution using information of global distribution and local search. This paper extends the work in EDA/LS by replacing the cheap local search by the mean shift method [21]. Mean shift is a nonparametric density estimation method. It can also be applied to do optimization [22], which does not need any function evaluation to guide the optimization. This is the motivation why we try to use it and this paper reports our preliminary work on this investigation.

The rest of this paper is organized as follows. In Section II, the improved version of EDA/LS by mean shift is introduced in detail. The experiment result and analysis are given in Section III. Finally, this paper is concluded in Section IV.

## II. PROPOSED ALGORITHM

## A. Algorithm Description

Denote the EDA/LS guided by mean shift as EDA/LS-MS. In each generation, EDA/LS-MS maintains

- a set of $N$ populations $\left\{x_{1}, x_{2}, \cdots, x_{N}\right\}$,

- their objective values $\left\{f\left(x_{1}\right), f\left(x_{2}\right), \cdots, f\left(x_{N}\right)\right\}$. The algorithm framework of the proposed EDA/LS-MS is shown in Algorithm 1.


## Algorithm 1: Procedure of EDA/LS-MS

1 Initialize the population $p o p=\left\{x^{1}, \cdots, x^{N}\right\}$ and evaluate them;
2 while *not terminate* do
$M \leftarrow \operatorname{model}(p o p)$.
$\left\{y_{1}, \cdots, y_{N}\right\} \leftarrow \operatorname{sample}(M)$.
$\left\{z_{1}, \cdots, z_{\left\lfloor N P_{a}\right\rfloor}\right\} \leftarrow M S\left(p o p, P_{a}\right)$.
foreach *$y \in\left\{y_{1}, \cdots, y_{N}\right\}$* do
$k \leftarrow$ random_select $\left\{1,2, \cdots,\left\lfloor N P_{a}\right\rfloor\right\}$.
for $j=1$ to $n$ do
if $\operatorname{rand}()<P_{b}$ then
$y^{j} \leftarrow z_{k}^{j}$.
end
end
end
Evaluate $\left\{y_{1}, \cdots, y_{N}\right\}$.
$p o p \leftarrow \operatorname{select}\left(\left\{y_{1}, \cdots, y_{N}\right\} \cup\left\{x_{1}, \cdots, x_{N}\right\}\right)$.
if convergent then
$t \leftarrow$ random_select $\left\{1,2, \cdots, N\right\}$.
$x^{*} \leftarrow$ Powell_search $\left(x_{t}\right)$.
if $f\left(x^{t}\right)<f\left(x^{*}\right)$ then
$x^{t} \leftarrow x^{*}$.
end
end
end
The algorithm is the same as EDA/LS except in Line 5 where the mean shift based search is applied. More details of the algorithm are referred to [20].

We would like to describe the algorithm from several perspectives as follow:

- Population Initialization: The initial population is uniformly and randomly sampled from the search space in Line 1.
- Termination Condition: The EDA/LS-MS terminates when a given maximum number of generations is reached in Line 2.
- Selection Procedure: The best solutions according to the objective function values are selected form the combination of the parent solutions and the new solutions in Line 14.
- Reproduction Procedure: Firstly, a probabilistic model is built based on the current population in Line 3. Then a set of candidate solutions are sampled form the model in Line 4, and some reference solutions are generated
by the mean shift search in Line 5. Some components of the candidate solutions are replaced by the reference solutions in Lines 6-14 and the procedure of MS will be given later. The concrete method of combination is in Lines 6-13. When the algorithm converges, the Powell based expensive local search is applied to improve a randomly selected solution in Lines 16-22.
Some details of the method will be discussed shortly in the following section.


## B. Mean Shift Based Search

Mean shift is a non-parametric feature-space analysis technique for locating the maxima of a density function. There is no need to calculate the values of estimation functions when we use mean shift to search optimal solutions. We have proved in [23] that the maximization of the density of a distribution equals to the maximization of a corresponding objective. In this section, we propose a local search strategy based on mean shift.

As proposed in [21], the mean shift algorithm assumes that the data points in a $d$-dimensional Euclidean space $R^{d}$ are independent and identically distributed samples taken from a population with an unknown density function $\hat{f}(x)$. The kernel density estimation at the location $x$ can be calculated as follows:

$$
\hat{f}_{h, K}(x)=\frac{1}{n h^{d}} \sum_{i=1}^{N} K\left(\left\|\frac{x-x_{i}}{h}\right\|^{2}\right)
$$

with the bandwidth parameter $h>0$ and the scalar kernel function $K$ under the conditions given in [21].

To maximize $\hat{f}(x)$, the gradient of the density estimator is formulated by exploiting the linearity of (2):

$$
\hat{\nabla} f_{h, K}(x)=\frac{1}{n h^{d}}\left[\sum_{i=1}^{N} g\left(\left\|\frac{x-x_{i}}{h}\right\|^{2}\right)\right] m_{h, g}(x)
$$

where

$$
m_{h, g}(x)=\frac{\sum_{i=1}^{N} x_{i} g\left(\left\|\frac{x-x_{i}}{h}\right\|^{2}\right)}{\sum_{i=1}^{N} g\left(\left\|\frac{x-x_{i}}{h}\right\|^{2}\right)}-x
$$

and

$$
g(x)=-K^{\prime}(x)
$$

In order to obtain the direction of the point with maximum density, the value in (3) should equal to zero. Hence, we can attain the new coordinate value of $x$ as follow:

$$
x_{\text {new }}=\frac{\sum_{i=1}^{N} x_{i} g\left(\left\|\frac{x-x_{i}}{h}\right\|^{2}\right)}{\sum_{i=1}^{N} g\left(\left\|\frac{x-x_{i}}{h}\right\|^{2}\right)}
$$

It is obvious that $x$ will converge at a nearby point where the multivariate kernel density estimator has zero gradient after sufficient iterations. Fig. 1 illustrates the idea of applying the mean shift method on searching for the local density maxima. The initial point keeps moving to the new mean location along the direction of the nearest stationary point.

In standard method, the bandwidth is a constant value, which means it might not have much impact on the procedure of density estimation when the distances of all data points are very small. So, we provide a method to update the bandwidth adaptively and make some improvements in (6):

$$
x_{\text {new }}=\frac{\sum_{i=1}^{m} x_{i} \varrho\left(\left\|\frac{x-x_{i}}{\pi}\right\|^{2}\right)}{\sum_{i=1}^{m} \varrho\left(\left\|\frac{x-x_{i}}{\pi}\right\|^{2}\right)}
$$

where $\|x\|^{2}$ is $L_{2}$ norm of $x, m$ is the number of points that are used to calculate the coordinate value of new solution, $s$ is the adaptive bandwidth of searching window calculated as
follow:

$$
s=\sqrt{\frac{1}{d} \sum_{j=1}^{d}\left(p^{j}-q^{j}\right)^{2}}
$$

where $p$ and $q$ is the maximum and the minimum values of all the solutions in the current population.

It should be noted that the kernel function in the mean shift process essentially imposes additional weights on the data points according to their distances to the shifting mean [24]. Cheng [22] described two main types of kernel functions that have frequently been used in the mean shift research, namely flat and Gaussian kernel. Compared to Gaussian kernels, flat kernel gives these points that close to the initial point the same weights, which ignores the influence of the distance between

TABLE II
MEDIAN,STD. VALUES OF THE RESULTS OBTAINED BY THE TWO COMPARISON ALGORITHMS AFTER 500, 1000, AND 1500 GENERATIONS OVER 20 RUNS FOR ALL THE TEST INSTANCES.

![img-0.jpeg](img-0.jpeg)

Fig. 1. Illustration of the search procedure of a mean shift
two points. In the paper, we use the following Gaussian kernel.

$$
g(u)=\frac{1}{\sqrt{2 \pi}} e^{-\frac{1}{2}(u)^{2}}
$$

where

$$
u=\left\|\frac{x-x_{i}}{s}\right\|^{2}
$$

The value of $u$ represents the distance between two points. To make the algorithm more effective, the value of kernel function will be set as zero when $u>2$. Under this condition, the distant point will not have any impact on the procedure of mean shift.

The detailed algorithm framework of the mean shift based search strategy is described in Algorithm 2.

## Algorithm 2: $\left\{z_{1}, \cdots, z_{\left\lfloor N P_{n}\right\rfloor}\right\} \leftarrow M S\left(p o p, P_{n}\right)$

Set $p^{j}=\max _{x \in p o p} x^{j}$ and $q^{j}=\min _{x \in p o p} x^{j}$ for $j=1, \cdots, d$.
Calculate $s$ as (8).
Choose the best $\left\lfloor N P_{n}\right\rfloor$ solutions from $p o p$ and save them in $Q$.
For each $x \in Q$, estimate a new position $z$ by (7).

## III. EXPERIMENTAL RESULTS

In this section, we compare EDA/LS-MS with EDA/LS on 12 widely used benchmark functions from [25]. The 12 benchmark functions contain nine unimodal functions $f_{1}-f_{9}$ and 3 multimodal functions $f_{10}-f_{12}$. All the test instances have a global minimum objective value of 0 . The details of these test instances are listed in Table I.

## A. Parameter Settings

The parameters in the experiment study are as follows:

- The population size $N=150$ and the dimension of the test instance is $n=30$ for all test instances.
- The maximum number of generations is $G=2000$ and the two algorithms are executed independently for 20 runs for each instances.
- EDAs : The number of bins used in a VWH model, which is proposed in [12], is $M=15$;
- The proportion of the new solutions generated by MS in the EDAs solutions $P_{n}=0.2$; The probability to use the location information $P_{h}=0.2$; and the convergence threshold is $\theta=0.1$;

![img-1.jpeg](img-1.jpeg)

Fig. 2. The median function value of the best solutions obtained by the two methods versus function evaluation on f1-f12.

All the algorithms are implemented in Matlab R2010b and executed in Lenovo Thinkpad E430 with i5-3210M CPU @ 2.50GHz, 6.00GB RAM, and Windows 7.

## B. Comparison Results and Analysis

EDA/LS-MS is compared with EDA/LS on the 12 test instances. The median and standard deviation of the results obtained by the two algorithms after 500, 1000, and 1500 generations over 20 independent runs are shown in Table II.

Fig. 2 shows the median function values obtained by the two algorithms versus the generations on $f_{1}-f_{12}$.

In Table II, it can be seen clearly that EDA/LS-MS outperforms EDA/LS in most functions after 500 generations and both EDA/LS-MS and EDA/LS converges to the global optimal on $f_{6}$ and $f_{9}$. EDA/LS-MS achieves the goal on $f_{9}$ and $f_{12}$ though EDA/LS dose not reach the stage of convergence. With the increase of the number of generations, It can be seen that the results in EDA/LS and EDA/LS-MS are improved

TABLE III
MEAN $\pm$ STD. VALUES OF THE RESULTS OBTAINED BY EDA/LS-MS AFTER 2, 000 GENERATIONS OVER 20 RUNS FOR ALL THE TEST INSTANCES WITH DIFFERENT VALUES OF $(s=10,15,20$, AND AN ADAPTIVE VALUE $)$.


obviously on $f_{1}-f_{5}$ after 1000 generations. In the meanwhile, the statistical results of the two algorithms are consistent with each other on $f_{1}, f_{5}-f_{12}$ and EDA/LS-MS performs better than EDA/LS on $f_{2}-f_{4}$. EDA/LS continues to converge whereas EDA/LS-MS remains moderate after 1500 generations and the two algorithms both perform well on $f_{1}, f_{3}-f_{6}, f_{8}-f_{12}$. In the finial stages, the results of EDA/LS are better than those of EDA/LS-MS in most test instances. It is evident that EDA/LSMS converges quickly in its early stage and gets a better result than EDA/LS on $f_{4}$.

As is shown in Fig. 2, EDA/LS-MS converges faster than EDA/LS on most test instances. It it obvious that EDA/LS-MS reaches the convergent stage earlier than EDA/LS on $f_{1}-f_{4}$, $f_{8}-f_{10}, f_{12}$ and the speed of convergence of the two algorithms are consistent with each other on $f_{5}-f_{7}$ and $f_{11}$. In EDA/LSMS , there are very significant downward trends of median function value on $f_{3}, f_{4}, f_{9}$ and $f_{12}$. The reason that EDA/LSMS converges faster than EDA/LS could be that the mean shift method plays an significant role at the convergence rate in searching for a local optimal solution .

## C. Sensitivity to Control Parameters

In this section, the influence of control parameters on the EDA/LS-MS will be discussed. During the procedure of mean shift, bandwidth and the number of chosen solutions in (7) are the major control parameters. We use $s$ and $m$ to denote them respectively.

In the procedure of calculating the value of density estimation, the bandwidth of the searching window can be defined as a constant or a variable. $m$ is the number of solutions that used to calculate the coordinate value of a new solution. In general, the solution of the better function value is chosen as the candidate. We set $s=10,20,30$, and the adaptive value in (8), $m=15,25$, and 35 . The other parameters of EDA/LS-MS
are set as the values used in the previous section. $f_{3}$ and $f_{4}$ are chosen for the study.
![img-2.jpeg](img-2.jpeg)
(a) $f_{3}$
![img-3.jpeg](img-3.jpeg)
(b) $f_{4}$

Fig. 3. The median function values obtained by EDA/LS-MS with different parameter settings on $f 3$ and $f 4$.

It is clear from Fig. 3 that $m$ has a significant impact on the performance of EDA/LS-MS. The statistical results become better with the decline of value $m$ and reach the best

stages when $m=15$. It can be seen that $m$ makes a great improvement in the performance on $f_{4}$. EDA/LS-MS with $m$ $=15$ performs better than EDA/LS-MS with $m=25$ and 35 . Furthermore, we can see that when $s$ is the adaptive value, EDA/LS-MS with $m=15$ performs the best while when $s$ $=30$, EDA/LS-MS with $m=35$ performs the worst. From the plot, the influence of $s$ on the performance is very small and the results of function keep steady with the four different values of $s$. It can be noted that EDA/LS-MS performs a little better when $s$ is the adaptive value on $f_{3}$ and $f_{4}$ than other constant values.

As we can see, there is not much difference in the performance of EDA/LS-MS with four distinct values of bandwidth. The experiment results of the mean and std. deviation values of the algorithm over 20 runs for the test instances after 2000 generations with different values of bandwidth are shown in Table III. It is obvious that all of them perform well and achieve the optimal zero on $f_{6}, f_{9}$, and $f_{11}$. On $f_{12}$, EDA/LSMS with $s=30$ and the adaptive value outperform than EDA/LS-MS with $s=10$ and 20.
![img-4.jpeg](img-4.jpeg)
(a) $f_{6}$
![img-5.jpeg](img-5.jpeg)
(b) $f_{9}$
![img-6.jpeg](img-6.jpeg)
(c) $f_{12}$
![img-7.jpeg](img-7.jpeg)

Fig. 4. The mean function values obtained by EDA/LS-MS with different settings of bandwidth versus generations on $f_{6}, f_{9}$, and $f_{12}$.

The change of bandwidth does not affect the value of final solution. However, the speed of convergence is largely influenced by the choice of bandwidth in most test instances. Fig. 4 shows the average objective values versus generations on $f_{6}, f_{9}$ and $f_{12}$ respectively with different settings of $s=10,20,30$, and an adaptive value in (8). We can see that the value of function decline sharply after 200 generations on $f_{12}$ with the adaptive value. It is obvious that the variable bandwidth outperforms other constants by the speed of achieving the convergence. The strategy of setting a variable value to the bandwidth can raise the efficiency of convergence in EDA/LS-MS.

## IV. CONCLUSIONS

The estimation of distribution algorithm is widely used to solve global optimization problems. It is noted that new solutions are created by probabilistic models in EDA without the location information from parents. In this paper, we propose a new algorithm, named EDA/LS-MS, to guide EDA with mean shift. In this approach, we combine both population distribution information and individual location information for generating better offspring solutions to speed up the algorithm convergence.

To evaluate the performance of our approach, 12 test instances are used as the benchmark functions. The experiment results indicate that EDA/LS-MS can obtain good performance and have a faster convergence rate compared to EDA/LS on most of functions. The reason might be that mean shift can help to locate promising areas quickly. We also empirically studied the influences of bandwidth in the mean shift with different values. The results suggest that adaptive bandwidth is a better choice than other constant values.

The work reported in this paper is preliminary and some work has been left for further investigation. In the future, the influence of different kernel function in mean shift will be studied. Beside, combining mean shift with other EAs is another direction.

## ACKNOWLEDGMENT

This work is supported by China National Instrumentation Program under Grant No.2012YQ180132, the National Natural Science Foundation of China under Grant No.61273313, and the Science and Technology Commission of Shanghai Municipality under Grant No.14DZ2260800.
