# Clustering Molecular Dynamics Trajectories with a Univariate Estimation of Distribution Algorithm 

Rodrigo C. Barros*, Christian V. Quevedo*, Renata De Paris* and Márcio P. Basgalupp ${ }^{\dagger}$<br>*Pontificia Universidade Católica do Rio Grande do Sul<br>Faculdade de Informática, Porto Alegre, RS, Brazil<br>Email: rodrigo.barros@pucrs.br<br>${ }^{\dagger}$ Universidade Federal de São Paulo<br>Instituto de Ciência e Tecnologia, São José dos Campos, SP, Brazil<br>Email: basgalupp@unifesp.br


#### Abstract

Molecular Dynamics simulations of protein receptors are an emergent tool in rational drug discovery. Nevertheless, employing Molecular Dynamics trajectories in virtual screening of large repositories is a very costly procedure, which ultimately may become unfeasible. Data clustering have been applied in this context with the goal of reducing the overall computational cost in order to make this task feasible. In this paper, we develop a novel estimation of distribution algorithm called Clus-EDA for clustering entire trajectories using structural features from the substrate-binding cavity of the protein receptor. This novel approach is capable of reducing the original trajectory to about $4 \%$ of its original size whilst keeping all relevant information for the analysis of receptor-ligand binding. The resulting partition generated by the estimation of distribution algorithm is further validated by analyzing the interactions between 20 ligands and a Fully-Flexible Receptor model containing a 20 ns Molecular Dynamics simulation trajectory. Results show that Clus-EDA is capable of outperforming traditional clustering algorithms such as $k$-means and hierarchical clustering by providing the smallest variance of the free energy of binding within the conformations in each cluster.


## I. InTRODUCTION

Proteins are flexible systems, and such a flexibility is key in determining their corresponding functions [1]. Rational drug design is an emerging technology which attempts to map the behavior of a protein and its potential binding to a given drug candidate. It is the interaction between drug candidates (hereby also referred to as ligands) and target proteins (receptors) in computational simulations that form the basis of rational drug design. The rationale is the following: given a receptor, molecular docking experiments sample a large number of conformations and orientations of a candidate ligand within the protein binding site. The energy provided by the potential binding of ligand and receptor roughly indicates whether the ligand is a potential drug for the given disease [2].

The major problem with molecular docking software nowadays is that they only consider the flexibility of the ligand, whereas the receptor is assumed to be a rigid structure. This is explained due to the large computational cost that is required for also considering the receptor's flexibility. Among the available methodologies to explicitly consider the receptor's flexibility in docking simulations, a possible alternative is to select a series of different conformations derived from a 978-1-4799-7492-4/15/531.00 (C)2015 IEEE

Molecular Dynamics (MD) simulation of the target receptor. MD simulation is a well-known strategy to investigate in detail the atomic dynamic behavior of proteins in aqueous solution. It recognizes subtle internal motions and slow conformational deviations, including bond vibration, chain reorientation, and backbone rearrangements at different timescales [3], [4].

MD simulations are intrinsically a time-consuming process. The computational cost largely increases when docking experiments are used for the fast screening of virtual libraries against an entire MD ensemble in order to exploit all conformations of the protein receptor [3]. These MD ensembles, hereby called a Fully-Flexible Receptor (FFR) model, typically hold over $10^{4}$ MD structures. For this reason, recent studies on combining docking and MD simulations have developed novel techniques to systematically reduce the number of MD structures without losing essential information, usually employing clustering algorithms for achieving the desired reduction [5]-[7]. By clustering highly-similar MD conformations regarding their substrate-binding cavities, one can extract the most relevant information during the molecular docking experiments, reducing its overall computational cost. Even though clustering is the approach employed in this work, we note that several papers employ learning approaches for the domain of molecular dynamics, with goals as diverse as predicting bioactivities of ligands to target proteins [8], drug classification [9], [10], and free energy of binding prediction [11], [12].

In this paper, we propose a novel clustering algorithm for reducing the number of MD conformations and making it feasible to combine docking and MD simulations. Since data clustering is basically a combinatorial optimization problem, we propose a novel method based on the Estimation of Distribution Algorithms (EDAs), namely Clus-EDA. It is designed to considerably reduce the number of conformations (roughly keeping $\approx 5 \%$ of the original MD ensemble) while optimizing a measure of clustering validity. Our research hypothesis is that Clus-EDA is capable of outperforming traditional clustering algorithms in the task of reducing MD conformations. For verifying such a hypothesis, we analyze the partitions generated by Clus-EDA based on features from the binding cavity of an MD simulation regarding the InhA-NADH complex [13], and we compare the provided results with those achieved by $k$-means [14] and hierarchical agglomerative clustering [15].

This paper is organized as follows. Section II details our novel method for clustering MD simulations based on Estimation of Distribution Algorithms, namely Clus-EDA. Section III describes the methodology adopted for performing the empirical analysis, and the results of the experiments are discussed in Section IV. Section V presents work related to the proposed approach, and we end this paper with our conclusions and future work directions in Section VI.

## II. Clus-EDA

Clus-EDA is an Estimation of Distribution Algorithm (EDA) for data clustering. EDAs are a particular class of evolutionary algorithms that explore the space of candidate solutions by building and sampling explicit probabilistic models of promising solutions [16]. The main characteristic of EDAs is the absence of random operators during evolution. Instead of employing these nature-inspired genetic operators, the future populations are generated by learning and simulating a probability distribution based on the individuals that are selected from the current population [17].

Clus-EDA samples solutions encoded by a probabilistic model, which is responsible for determining whether each object in a dataset is a medoid or not. A medoid is a cluster representative, and the number of medoids indicate the number of clusters found by Clus-EDA. Each individual in Clus-EDA is a binary vector of size $n$, where $n$ is the number of objects in the dataset - in our case, the number of conformations of an MD simulation. Since we are working with a FFR model that contains a 20 ns MD simulation trajectory, the number of objects in the trajectory dataset is 20,000. Figure 1 depicts the encoding scheme in Clus-EDA.
![img-0.jpeg](img-0.jpeg)

Fig. 1. Individual representation in Clus-EDA. Each gene corresponds to an object, and the encoding indicates whether the object is a medoid (1) or not $(0)$.

Clus-EDA is a univariate EDA also regarded as a univariate marginal distribution algorithm (UMDA) [18]. It employs a binary probability vector $p=\left(p_{1}, p_{2}, \ldots, p_{n}\right)$ as its probabilistic model, where $p_{i}$ denotes the probability of object $\mathbf{x}_{i}$ to be a medoid. To learn the probability vector, each $p_{i}$ is set to the proportion of 1 s in the population of selected individuals. Clus-EDA follows the pseudocode described in Algorithm 1.

```
Algorithm 1 Clus-EDA high-level pseudocode.
    initialize probability vector \(p\)
    sample \(p\) to generate initial population \(P\)
    while (not done) do
        select population of promising solutions \(S\) from \(P\)
        update probability vector \(p\) with \(S\)
        sample \(p\) to generate new candidate solutions \(N\)
        erase \(P\) and incorporate \(N\) into \(P\)
    end while
```

Since our goal is to considerably reduce the size of an MD simulation, we initialize the probability vector $p$ with
probability of 0.05 for every single position. In other words, the initial probability for each object to be a medoid is $5 \%$. In each generation of Clus-EDA, we employ the truncation method for selection, which chooses $50 \%$ of the fittest individuals of that particular generation to update the probabilistic model. Once the model is updated, Clus-EDA samples the probability vector $p$ to generate an entire novel population of individuals that fully replace the previous generation. The iteration continues until a maximum number of generations is achieved.

## A. Decoding Individuals into Partitions

Clus-EDA is an evolutionary hard partitional clustering algorithm. Given a set of $n$ objects to be clustered, $\mathbf{X}=$ $\left\{\mathbf{x}_{1}, \mathbf{x}_{2}, \ldots, \mathbf{x}_{n}\right\}$, a hard partition is a collection of $k$ nonoverlapping clusters $\mathbf{P}=\left\{\mathbf{C}_{1}, \mathbf{C}_{2} \ldots, \mathbf{C}_{k}\right\}$ such that:

- $\quad \mathbf{C}_{1} \cup \mathbf{C}_{2} \cup \ldots \cup \mathbf{C}_{k}=\mathbf{X}$
- $\forall i, \mathbf{C}_{i} \neq \emptyset$
- $\quad \mathbf{C}_{i} \cap \mathbf{C}_{j}=\emptyset$ for $i \neq j$

For decoding the individuals into partitions, the first step is to identify which objects are defined as medoids. Note that the number of clusters is variable since it is constantly updated according to the EDA's probabilistic model. For each nonmedoid object $\mathbf{x}_{i}$, Clus-EDA computes the Euclidean distance between $\mathbf{x}_{i}$ and every single medoid, and finally assigns $\mathbf{x}_{i}$ to the cluster represented by its closest medoid.

The binary encoding adopted by Clus-EDA has several advantages over other typical encodings in evolutionary clustering problems. For instance, let us consider the case of the integer encoding in which each gene (object) has a value over the alphabet $1,2, \ldots, k$. Such an encoding is naturally redundant (1-to-many), since there are $k$ ! different genotypes that represent the same solution [19]. Furthermore, it assumes the number of clusters $k$ is previously known, which is often not the case in real world applications, such as the one that is being approached in this paper.

## B. Fitness Function

For evaluating how fit an individual is in Clus-EDA, we make use of an efficient clustering validity criterion, namely the simplified silhouette width criterion (SSWC) [20]. It is an efficient implementation of the well-known silhouette width criterion (SWC) [21], which is given by:

$$
\begin{gathered}
S W C=\frac{1}{n} \sum_{i=1}^{n} s(i) \\
s(i)=\frac{b(i)-a(i)}{\max \{a(i), b(i)\}}
\end{gathered}
$$

where $a(i)$ is the average dissimilarity between the $i^{\text {th }}$ object and its cluster, and $b(i)$ is the average dissimilarity between the $i^{\text {th }}$ object and the nearest neighbor cluster. For singletons (clusters with a single object $\mathbf{x}_{j}$ ), it is assumed by convention that $s(j)=0$.

The difference between $S S W C$ and the original $S W C$ is in how $a(i)$ and $b(i)$ are computed. Whereas $S W C$ computes

the average dissimilarity by employing all objects belonging to the corresponding cluster (complexity of $O\left(n^{2}\right)$ ), SSWC computes the average dissimilarity by using the cluster prototypes instead (complexity of $O(n)$ ). Clus-EDA employs the $S S W C$ as its fitness function, computing the average dissimilarity based on distances to the corresponding medoids.

Besides the possibility of employing $S S W C$ as a singleobjective fitness function, Clus-EDA also allows the search for a trade-off between performance (as given by $S S W C$ ) and complexity (given by the number of clusters). The idea is to penalize solutions with too many clusters. Since $S S W C \in$ $[-1,+1]$ is a measure that should be maximized, we decrease it by a factor of $w \times k$, where $w$ is a user-defined parameter and $k$ is the number of clusters.

## III. Methodology

In this section, we present the Molecular Dynamics dataset in detail, and the experimental methodology that was employed for comparing Clus-EDA with $k$-means [14] and hierarchical agglomerative clustering [15] in the task of clustering MD trajectories.

## A. MD Trajectory Data

The MD trajectory data comprises conformational features from the substrate-binding cavity of an MD simulation considering the InhA-NADH complex from Mycobacterium tuberculosis (PDB ID: 1ENY) as described in [13]. Data for the MD ensemble were collected at every 1 ps , resulting in a set of 20,000 instantaneous receptor conformations. The structural properties that were extracted from the substrate-binding cavity of every MD conformation are:

1) the pairwise RMSD distances between binding cavity atoms (in $\AA$ );
2) the volume (in $\AA^{3}$ ); and
3) the number of heavy atoms of each residue that belongs to the substrate-binding cavity of the enzyme (PDB ID: 1BVR) [22].

The first property (pairwise RMSD distances) was evaluated by monitoring the differences between the backbone atoms ( $\mathrm{N}, \mathrm{C} \alpha, \mathrm{C}$, and O ) within the substrate-binding cavity from the first structure against the conformation under comparison. The RMSD values were calculated using the ptraj module from AmberTools12 [23]. The second and third properties were collected using the CASTp software (Computed Atlas of Surface Topography of proteins) [24]. CASTp provides an online resource for locating, delineating, and measuring concave surface regions on three-dimensional structures of proteins based on the solvent-accessible surface area model [25] and the molecular surface model [26]. The measurement of volume for every MD conformation was obtained by considering the residues that encloses the cavity of the InhA substrate analog from the 1BVR structure [22], which contains the largest number of atoms. We collected the number of heavy atoms from the 10 main residues that lie in the substrate-binding cavity of the enzyme (Figure 2).

Our final objective is to cluster different behaviors found within the substrate-binding cavity along an MD simulation,
![img-1.jpeg](img-1.jpeg)

Fig. 2. Substrate-binding cavity of the InhA enzyme from Mycobacterium tuberculosis (PDB ID: 1BVR) identified by the CASTp software. The protein receptor, with secondary structures represented by ribbons, is colored grey. The residues are represented in sticks within the molecular surface, which represents the substrate-binding cavity. Image generated by PyMol [27].
drastically reducing the number of snapshots in the FullyFlexible receptor model while keeping all relevant information from the original number of snapshots.

## B. Baseline Algorithms

In order to verify the effectiveness of Clus-EDA in reducing the number of MD conformations and making it feasible to combine docking and MD simulations, we analyze the obtained results with those provided by well-known clustering algorithms, namely $k$-means [14] and UPGMA [15], the latter being a hierarchical agglomerative clustering algorithm.
$k$-means is a well-known partitional method that locally optimizes the average squared distance between objects and their nearest cluster center (centroid). It randomly generates $k$ centroids, and refines them throughout several iterations, where it computes the distance of every object to the $k$ centroids in order to determine the cluster memberships [14]. To make the resulting $k$ clusters as compact and separate as possible, the $k$-means algorithm minimizes the sum of squared errors $(J)$ between every object $\mathbf{x}_{i}$ that belongs to a given cluster $C_{j}$ and its centroid $c_{j}$, for all $k$ clusters, as follows:

$$
J=\sum_{j=1}^{k} \sum_{\mathbf{x}_{i} \in \mathbf{C}_{j}} \operatorname{dist}\left(\mathbf{x}_{i}, c_{j}\right)^{2}
$$

where $\operatorname{dist}(a, b)$ is the Euclidean distance between $a$ and $b$.
Unlike partitional clustering methods such as $k$-means, hierarchical clustering algorithms seek to cluster data into levels of a hierarchical structure, such as a "tree" of clusters [28]. They can be divided into two basic approaches, namely agglomerative and divisive clustering. Agglomerative hierarchical clustering employs the bottom-up strategy, starting with

each object as a singleton (cluster with a single object) and iteratively merging the closest pair of clusters until all the objects lie within a single cluster or the maximum number of clusters is reached. Divisive hierarchical clustering, on the other hand, employs the top-down strategy, starting with all objects within the same cluster and splitting a cluster into smaller clusters until each object becomes a singleton cluster or a termination condition holds. We decided to employ an agglomerative algorithm since the divisive methods cannot efficiently handle large datasets. To measure the proximity between two objects in different clusters, the agglomerative algorithms employ distinct strategies, each one defining its method's name: single linkage, complete linkage, median, centroid, group average, and Ward's.

In UPGMA [15], which is a group average based agglomerative algorithm, the distance between two clusters is defined as the average pairwise proximity among all pairs of objects in different clusters. UPGMA takes into account the number of objects in each cluster, as follows:

$$
U P G M A\left(\mathbf{C}_{i}, \mathbf{C}_{j}\right)=\frac{1}{\left|\mathbf{C}_{i}\right|\left|\mathbf{C}_{j}\right|} \sum_{\mathbf{x} \in \mathbf{C}_{i}} \sum_{\mathbf{y} \in \mathbf{C}_{j}} \operatorname{dist}(\mathbf{x}, \mathbf{y})
$$

Both $k$-means and UPGMA require the number of clusters, $k$, to be set by the end-user.

## C. Validation of Data Partitions

After Clus-EDA generates its final near-optimal partition, we perform exhaustive docking experiments on AutoDock4.2 [29] in order to search for evidence that validates the quality of such a partition. These experiments are conducted between 20,000 snapshots (FFR model) and 20 different compounds, which are extracted from 20 InhA structures deposited at PDB [30]. Figure 3 shows the 3D structures of the 20 compounds and the rotatable bounds defined in the docking experiments.

In order to preserve the reaction mechanism between ligands and the target protein, NADH should be treated as a coenzyme. Hence, for experiments with ligands, the coenzyme was considered as part of the protein receptor structure. Conversely, we removed the NADH coenzyme from each snapshot of the FFR model when we performed the experiments with adducts (INH-NAD and PTH-NAD), since they already have the coenzyme as part of their structures.

Once the exhaustive molecular docking experiments are performed, we analyze the agreement among snapshots that lie within the same cluster. For each snapshot, the docking experiments produce a value of the free energy of binding (FEB) of that particular receptor conformation with the ligand at hand. Hence, the rationale for validating a clustering partition is the following: a good partition should have snapshot clusters with low FEB variance regarding the FEB achieved by the cluster representative (medoid). Such a measure is hereby referred to as $F E B_{\text {var }}$, and is given by:

$$
F E B_{v a r}=\frac{\sum_{j=1}^{k} \sum_{\mathbf{x}_{i} \in \mathbf{C}_{j}}\left(F E B_{\mathbf{x}_{i}}-F E B_{\mu_{j}}\right)^{2}}{k-s}
$$

where $F E B_{\mathbf{x}_{i}}$ is the free energy of binding between the snapshot represented by object $\mathbf{x}_{i}$ and the corresponding ligand, and $F E B_{\mu_{j}}$ is the free energy of binding between the representative snapshot (cluster medoid) and the corresponding ligand. Finally, $s$ is the number of singletons, which should be excluded from the computation since singletons have a single object (the cluster medoid) and thus a null deviation. If singletons were taken into account, partitions with many singletons would artificially reduce the final $F E B_{\text {var }}$ value.

The lower the $F E B_{\text {var }}$, the greater the agreement among snapshots that were clustered together, which means that all snapshots that lie within the same cluster may be discarded except for their representative, which is now the only required snapshot to be used during the molecular docking experiments.

Besides the biological validation through the analysis of $F E B_{\text {var }}$ values, we also analyze the $S S W C$ values of the resulting partitions generated by Clus-EDA and the baseline algorithms $k$-means and UPGMA.

## D. Parameters

Clus-EDA is an evolutionary algorithm, and as such it requires two main parameters to be set a priori: number of individuals and number of generations. In the experiments, we set those values to 500 individuals and 500 generations, and no effort towards parameter tuning was performed whatsoever. The selection mechanism in Clus-EDA is by truncation, which defines that $50 \%$ of the individuals in the current generation are used to update the probabilistic model.

For the fitness function that penalizes $S S W C$ 's value according to the number of clusters in the partition, we set the penalizing factor $w$ to 0.00005 , which means that a partition with 5,000 clusters penalizes $S S W C$ in 0.25 , whereas the trivial solution (a partition with 20,000 clusters) decreases the value of $S S W C$ in 1 unity.

Finally, we set the probability of generating medoids in the initial population to $5 \%$, considering that we could achieve a considerable reduction in computational effort by reducing the MD simulation to around 1,000 receptor snapshots ( $5 \%$ of the total size of the trajectory, which is 20,000 snapshots). Nevertheless, we are aware that the initial probability of $5 \%$ of generating medoids will be iteratively updated by Clus-EDA, and no further constraint on $k$ is imposed here.

## E. Statistical Analysis

In order to provide some reassurance about the validity and non-randomness of the results, we validate our novel algorithm by presenting results of statistical tests that follow the approach proposed by Demšar [32].

In a nutshell, this approach seeks to compare multiple algorithms on multiple datasets, and it is based on the use of the Friedman test with a corresponding post-hoc test. The Friedman test is a non-parametric counterpart of the ANOVA test, as follows. Let $R_{i}^{j}$ be the rank of the $j^{\text {th }}$ of $k$ algorithms on the $i^{\text {th }}$ of $N$ data sets. The Friedman test compares the average ranks of algorithms, $R_{j}=\frac{1}{N} \sum_{i} R_{i}^{j}$. The Friedman statistic is given by:

![img-2.jpeg](img-2.jpeg)

Fig. 3. Stick representation of the 3D structures of the 20 ligands used in docking experiments. Each ligand, with its structures colored by atom type, is identified by their name and its corresponding PDB ID. The dashed circle represents the rotatable bounds selected by AutoDockTools 1.5.6 [31].

$$
\chi_{F}^{2}=\frac{12 N}{k(k+1)}\left[\sum_{j} R_{j}^{2}-\frac{k(k+1)^{2}}{4}\right]
$$

is distributed according to $\chi_{F}^{2}$ with $k-1$ degrees of freedom, when $N$ and $k$ are big enough.

Iman and Davenport [33] prove that Friedman's $\chi_{F}^{2}$ is undesirably conservative, and thus they derive an adjusted statistic:

$$
F_{f}=\frac{(N-1) \times \chi_{F}^{2}}{N \times(k-1)-\chi_{F}^{2}}
$$

which is distributed according to the $F$-distribution with $k-1$ and $(k-1)(N-1)$ degrees of freedom.

If the null hypothesis of similar performances is rejected, then we proceed with the Nemenyi post-hoc test for pairwise
comparisons. The performance of two classifiers is significantly different if their corresponding average ranks differ by at least the critical difference:

$$
C D=q_{\alpha} \sqrt{\frac{k(k+1)}{6 N}}
$$

where critical values $q_{\alpha}$ are based on the Studentized range statistic divided by $\sqrt{2}$.

## IV. ReSULTS

We executed Clus-EDA, $k$-means, and UPGMA in the MD trajectory dataset described in Section III-A. Since Clus-EDA is a stochastic approach, we execute it 10 times by varying the seed of the random number's generator. Both $k$-means and UPGMA have a single parameter, which is the number of clusters $k$, and since they are deterministic approaches, they are executed a single time. Instead of averaging the results from the multiple executions of Clus-EDA, we present the results

from the best and the worst executions according to the fitness function's values.

The results reported in this section for $k$-means and UPGMA are regarding the $F E B_{\text {var }}$ and $S S W C$ values collected from the partitions with the same $k$ value than the one generated by Clus-EDA, since $F E B_{\text {var }}$ tends to monotonically decrease as the number of clusters increase. Moreover, we executed two versions of Clus-EDA. The first version, hereinafter simply referred to as "Clus-EDA", employs the $S S W C$ value as its fitness function. The second version, namely Clus-EDA ${ }_{w f}$, employs the weighted formula that penalizes according to the number of clusters - $S S W C$ is decreased by a factor of $w \times k$.

Table I shows the $F E B_{\text {var }}$ results provided by the best executions of Clus-EDA and Clus-EDA ${ }_{w f}$. To be precise, the partitions found by Clus-EDA and Clus-EDA ${ }_{w f}$ were further evaluated in exhaustive molecular docking experiments using all the 20,000 snapshots and one ligand at a time, and for each ligand it was computed the $F E B_{\text {var }}$ for the corresponding partition. Recall that $F E B_{\text {var }}$ is an average of the within-cluster FEB dispersion. The best execution of Clus-EDA provided a partition with 5060 clusters, whereas the best execution of Clus-EDA ${ }_{w f}$ generated a partition with 779 clusters. The best (lowest) results are highlighted in boldface. Note that ClusEDA outperformed $k$-means and UPGMA in 16 out of the 20 ligands that were used during the experiments. Clus-EDA ${ }_{w f}$, in turn, also outperformed $k$-means and UPGMA in 16 out of the 20 ligands, though generating a much smaller number of clusters (779), considering it penalizes for large values of $k$.

TABLE I: $F E B_{\text {var }}$ VALUES OF THE PARTITIONS PROVIDED BY THE BEST EXECUTIONS OF CLUS-EDA AND CLUS-EDA ${ }_{w f}$.

Table II shows a similar picture than Table I, but now presenting the results of the worst executions of Clus-EDA and Clus-EDA ${ }_{w f}$. In this scenario, Clus-EDA once again outperformed $k$-means and UPGMA in 16 out of the 20
ligands, which was also the case of Clus-EDA ${ }_{w f}$. Note that no significant difference was noticed regarding the worst and best executions of both versions of Clus-EDA, indicating a stable performance throughout executions.

TABLE II. $F E B_{\text {var }}$ VALUES OF THE PARTITIONS PROVIDED BY THE WORST EXECUTIONS OF CLUS-EDA AND CLUS-EDA ${ }_{w f}$.

Finally, Table III presents the $S S W C$ values provided by both versions of Clus-EDA in the 4 experimental scenarios (varying the versions of Clus-EDA and whether picking the best or worst executions). Note that the partitions generated by Clus-EDA consistently present much better values of $S S W C$ than UPGMA and $k$-means, indicating that the resulting clusters are compact and reasonably well-separated.

TABLE III. $\quad S S W C$ VALUES OF THE PARTITIONS PROVIDED BY CLUS-EDA VERSIONS AND BY THE BASELINE ALGORITHMS.

The next step of the experiments is to verify whether the differences in rank values are statistically significant. For that, we employ the graphical representation suggested by Demšar [32], the critical diagrams. In this diagram, a horizontal line represents the axis on which we plot the average rank values of the methods. The lowest (best) ranks are to the left of the diagram. When comparing all the algorithms against each other, we connect the groups of algorithms that are not significantly different through a bold line. We also show the critical difference given by the Nemenyi test above the graph.

Figure 4 shows the critical diagrams for all experimental configurations. Note that both versions of Clus-EDA out-

perform $k$-means and UPGMA with statistical significance, regardless of the fitness function and of the execution. Hence, we are confident to affirm that Clus-EDA is an effective approach for clustering MD simulations. Furthermore, by adjusting parameter $w$ in Clus-EDA ${ }_{w f}$, one can guide the search for solutions with different number of clusters, which ultimately indicates whether one needs a greater or smaller reduction in the computational cost of the task. Our results with Clus-EDA ${ }_{w f}$ reduce the MD simulation to 779 (best execution) and 817 (worst execution) snapshots, which accounts for a reduction of the trajectory size to $\approx 4 \%$ of its original size.
![img-3.jpeg](img-3.jpeg)

Fig. 4. Critical diagrams showing average ranks and Nemenyi's critical difference.

## V. Related Work

Since data clustering can be seen as a combinatorial optimization problem, several efforts towards building evolutionary algorithms for unsupervised problems have been proposed in the literature. We refer the interested reader to a thorough survey on the subject by Hruschka et al. [19], which describes several evolutionary algorithms (mainly genetic algorithms and genetic programming) for generating data partitions and data hierarchies. Notwithstanding, very few studies propose novel Estimation of Distribution Algorithms for data clustering.

Roure et al. [34] propose an EDA that performs partitional clustering with an integer encoding in which each gene has a value over the alphabet $1,2, \ldots, k$. As previously discussed, this encoding presents several disadvantages regarding the binary medoid-based encoding of Clus-EDA, such as the permutation problem and the need of defining the number of clusters $k$ in advance. Santana et al. [35] propose an EDA to select parameters for the Affinity Propagation clustering algorithm [36], with the final goal of performing gene expression classification. Meiguins et al. [37] propose the use of EDAs for the
automatic generation of density-based clustering algorithms, in an approach that makes use of an EDA as a hyper-heuristic to optimize macro-parameters of a density-based clustering strategy. Finally, note that several papers propose clustering strategies to enhance EDAs [17], [38]-[40], though not EDAs to generate clustering partitions, which is the case of ClusEDA. To the best of our knowledge, this paper presents the first EDA that generates data partitions following the binary medoid-based approach. Moreover, this is the first attempt in making use of evolutionary computation for clustering MD trajectories in order to reduce the computational cost of molecular docking experiments with a Fully-Flexible Receptor model.

## VI. CONCLUSIONS AND FUTURE WORK

In this paper, we presented Clus-EDA, which is a novel clustering algorithm based on a univariate estimation of distribution algorithm. We employed Clus-EDA for clustering a Molecular Dynamics trajectory that makes use of structural features from the substrate-binding cavity of the protein receptor. Our hypothesis was that Clus-EDA could considerably reduce the number of conformations of the molecular dynamics ensemble in order to allow the further execution of molecular docking experiments with ligands of interest.

Clus-EDA works by iteratively updating a univariate probabilistic model in order to select cluster representatives (medoids) that ultimately generate the final data partition. For that, Clus-EDA optimizes an internal clustering validity criterion, which is an efficient implementation of the silhouette width criterion [21].

For validating the proposed approach, we compared ClusEDA with traditional clustering algorithms such as $k$-means and an implementation of hierarchical agglomerative clustering over the Molecular Dynamics trajectory data regarding the InhA-NADH complex from Mycobacterium tuberculosis. Results show that the data partitions generated by Clus-EDA provide a reduction in variance of the free energy of binding for most of the tested ligands. Statistical non-parametric tests indicated that Clus-EDA outperforms the traditional clustering algorithms with statistical significance considering this bioinformatics task.

As future work, we intend to test different clustering validity criteria as fitness function, such as the Davies-Bouldin index [41], and also employ multi-objective optimization techniques such as the Pareto approach. Furthermore, we believe we can improve Clus-EDA with more sophisticated multivariate probabilistic models that do not assume independence among the variables.

## ACKNOWLEDGEMENTS

The authors would like to thank Brazilian research agencies FAPERGS (grant TO2054-2551/13-0), CNPq (grant 305984/2012-8), FAPESP (grant 2010/20255-5), and CAPES, for funding this research. Renata De Paris is supported by the HP-PROFACC grant. Christian Quevedo is supported by a CAPES/FAPERGS PhD scholarship. Moreover, the authors would like to thank Dr. Osmar Norberto de Souza and Dr. Duncan Ruiz for the MD simulation dataset and their expertise in the application domain.
